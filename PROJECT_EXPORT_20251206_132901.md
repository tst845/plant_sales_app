# –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–µ–∫—Ç–∞: plant_protection_app
**–î–∞—Ç–∞:** 2025-12-06 13:29:01
**–ü—É—Ç—å:** C:\Users\–ù–µ–ª–ª–∏\Desktop\file_for_run_python\plant_protection_app

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
  PROJECT_EXPORT_20251201_185440.md
  PROJECT_EXPORT_20251206_132901.md
  export_project_v1.py
  main.py
  main_db_test.py
  pyproject.toml
  app/
    README.txt
    __init__.py
    assets/
      disease_classes.txt
      database/
      fonts/
      models/
        plant_disease_model.tflite
    core/
      __init__.py
      config.py
      database.py
      database_backup.py
      test_data.py
    ml/
      __init__.py
      image_processor.py
      model_loader.py
    ui/
      __init__.py
      screens/
        __init__.py
        camera_screen.py
        catalog_screen.py
        disease_detection_screen.py
        main_screen.py
        orders_screen.py
        results_screen.py
        settings_screen.py
      widgets/
        __init__.py
        custom_buttons.py
        image_widgets.py
  resources/
  tests/
    __init__.py
    test_basic.py
```

## –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤

### üìÑ PROJECT_EXPORT_20251201_185440.md
**–†–∞–∑–º–µ—Ä:** 119681 –±–∞–π—Ç  
```markdown
# –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–µ–∫—Ç–∞: plant_protection_app
**–î–∞—Ç–∞:** 2025-12-01 18:54:40
**–ü—É—Ç—å:** C:\Users\–ù–µ–ª–ª–∏\Desktop\file_for_run_python\plant_protection_app

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
  PROJECT_EXPORT_20251201_185440.md
  export_project_v1.py
  main.py
  main_db_test.py
  pyproject.toml
  app/
    README.txt
    __init__.py
    assets/
      disease_classes.txt
      database/
      fonts/
      models/
        plant_disease_model.tflite
    core/
      __init__.py
      config.py
      database.py
      database_backup.py
      test_data.py
    ml/
      __init__.py
      image_processor.py
      model_loader.py
    ui/
      __init__.py
      screens/
        __init__.py
        camera_screen.py
        catalog_screen.py
        disease_detection_screen.py
        main_screen.py
        orders_screen.py
        results_screen.py
        settings_screen.py
      widgets/
        __init__.py
        custom_buttons.py
        image_widgets.py
  resources/
  tests/
    __init__.py
    test_basic.py
```

## –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤

### üìÑ PROJECT_EXPORT_20251201_185440.md
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```markdown

```

### üìÑ export_project_v1.py
**–†–∞–∑–º–µ—Ä:** 10701 –±–∞–π—Ç  
```python
import os
import pathlib
from datetime import datetime

def export_project(root_path=".", output_file="project_export.md"):
    """
    –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –æ–¥–∏–Ω Markdown —Ñ–∞–π–ª.
    """
    
    # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è
    exclude_dirs = {
        '.git', '__pycache__', '.pytest_cache', '.mypy_cache',
        'venv', '.venv', 'env', '.env', 'envs',
        '.vscode', '.idea', 'vs_code',
        'dist', 'build', '*.egg-info',
        'node_modules', 'coverage', '.coverage',
        '.github', '.gitlab', '.bitbucket',
        'poetry_env', 'virtual_env'  # –¥–æ–±–∞–≤–∏–ª —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è poetry
    }
    
    # –§–∞–π–ª—ã –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è
    exclude_files = {
        '*.pyc', '*.pyo', '*.pyd', '*.so',
        '*.db', '*.sqlite', '*.sqlite3', '*.log',
        'poetry.lock', 'package-lock.json', 'yarn.lock',
        '.gitignore', '.env', '.env.local', '.env.*',
        'Thumbs.db', 'desktop.ini'
    }
    
    root_path = pathlib.Path(root_path).resolve()
    
    with open(output_file, 'w', encoding='utf-8') as out:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        out.write(f"# –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–µ–∫—Ç–∞: {root_path.name}\n")
        out.write(f"**–î–∞—Ç–∞:** {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        out.write(f"**–ü—É—Ç—å:** {root_path}\n\n")
        
        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
        out.write("## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞\n\n")
        out.write("```\n")
        
        # –°–Ω–∞—á–∞–ª–∞ —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
        structure_lines = []
        
        for root, dirs, files in os.walk(root_path):
            # –§–∏–ª—å—Ç—Ä—É–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
            dirs[:] = [
                d for d in dirs 
                if d not in exclude_dirs 
                and not d.startswith('.')
                and not d.endswith('__pycache__')
            ]
            
            # –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å
            try:
                rel_root = pathlib.Path(root).relative_to(root_path)
            except ValueError:
                continue
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ—Ç—Å—Ç—É–ø
            if str(rel_root) == '.':
                indent_level = 0
            else:
                indent_level = len(rel_root.parts)
            
            indent = "  " * indent_level
            
            if str(rel_root) != '.':
                structure_lines.append(f"{indent}{rel_root.name}/")
            
            # –§–∞–π–ª—ã
            for file in sorted(files):
                if any(file.endswith(ext.strip('*')) for ext in exclude_files if '*' in ext):
                    continue
                if file in exclude_files:
                    continue
                if any(file == pattern for pattern in exclude_files):
                    continue
                    
                structure_lines.append(f"{indent}  {file}")
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
        for line in structure_lines:
            out.write(f"{line}\n")
        
        out.write("```\n\n")
        
        # –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤
        out.write("## –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤\n\n")
        
        file_count = 0
        total_size = 0
        excluded_count = 0
        
        for root, dirs, files in os.walk(root_path):
            # –§–∏–ª—å—Ç—Ä—É–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
            dirs[:] = [
                d for d in dirs 
                if d not in exclude_dirs 
                and not d.startswith('.')
                and not d.endswith('__pycache__')
            ]
            
            for file in sorted(files):
                file_path = pathlib.Path(root) / file
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —Ñ–∞–π–ª–æ–≤
                skip = False
                
                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é (—à–∞–±–ª–æ–Ω—ã —Ç–∏–ø–∞ *.pyc)
                for pattern in exclude_files:
                    if pattern.startswith('*'):
                        ext = pattern[1:]  # —É–±–∏—Ä–∞–µ–º –∑–≤–µ–∑–¥–æ—á–∫—É
                        if file.endswith(ext):
                            excluded_count += 1
                            skip = True
                            break
                    elif file == pattern:
                        excluded_count += 1
                        skip = True
                        break
                
                if skip:
                    continue
                
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
                if file.startswith('.'):
                    excluded_count += 1
                    continue
                
                try:
                    rel_path = file_path.relative_to(root_path)
                except ValueError:
                    continue
                
                # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–∑—ã–∫ –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
                ext = file_path.suffix.lower()
                lang_map = {
                    '.py': 'python',
                    '.js': 'javascript',
                    '.ts': 'typescript',
                    '.html': 'html',
                    '.css': 'css',
                    '.md': 'markdown',
                    '.json': 'json',
                    '.yml': 'yaml',
                    '.yaml': 'yaml',
                    '.txt': 'text',
                    '.toml': 'toml',
                    '.ini': 'ini',
                    '.xml': 'xml',
                    '.csv': 'csv',
                    '.sql': 'sql',
                }
                lang = lang_map.get(ext, '')
                
                out.write(f"### üìÑ {rel_path}\n")
                out.write(f"**–†–∞–∑–º–µ—Ä:** {file_path.stat().st_size} –±–∞–π—Ç  \n")
                
                try:
                    # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ä–∞–∑–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫
                    try:
                        content = file_path.read_text(encoding='utf-8')
                    except UnicodeDecodeError:
                        try:
                            content = file_path.read_text(encoding='cp1251')
                        except:
                            content = f"# –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª (–±–∏–Ω–∞—Ä–Ω—ã–π –∏–ª–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞)\n"
                    
                    # –û–±—Ä–µ–∑–∞–µ–º —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã
                    max_lines = 1000
                    lines = content.split('\n')
                    if len(lines) > max_lines:
                        content = '\n'.join(lines[:max_lines])
                        content += f"\n\n# ... —Ñ–∞–π–ª –æ–±—Ä–µ–∑–∞–Ω, –ø–æ–∫–∞–∑–∞–Ω–æ {max_lines} –∏–∑ {len(lines)} —Å—Ç—Ä–æ–∫ ..."
                    
                    out.write(f"```{lang}\n")
                    out.write(content)
                    if not content.endswith('\n'):
                        out.write('\n')
                    out.write("```\n\n")
                    
                    file_count += 1
                    total_size += file_path.stat().st_size
                    
                except Exception as e:
                    out.write(f"```\n# –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: {e}\n```\n\n")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        out.write("## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n\n")
        out.write(f"- **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** {file_count}\n")
        out.write(f"- **–ò—Å–∫–ª—é—á–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** {excluded_count}\n")
        out.write(f"- **–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä:** {total_size} –±–∞–π—Ç ({total_size/1024:.2f} KB)\n")
        out.write(f"- **–î–∞—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞:** {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")

if __name__ == "__main__":
    print("üîç –ü–æ–∏—Å–∫ –∫–æ—Ä–Ω—è Poetry –ø—Ä–æ–µ–∫—Ç–∞...")
    current_dir = pathlib.Path.cwd()
    
    # –ò—â–µ–º pyproject.toml –≤ —Ç–µ–∫—É—â–µ–π –∏–ª–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    project_root = None
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
    if (current_dir / "pyproject.toml").exists():
        project_root = current_dir
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω Poetry –ø—Ä–æ–µ–∫—Ç –≤ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ: {project_root}")
    
    # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏, –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é
    elif (current_dir.parent / "pyproject.toml").exists():
        project_root = current_dir.parent
        print(f"‚ö†Ô∏è  Pyproject.toml –Ω–∞–π–¥–µ–Ω –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–µ: {project_root}")
        print(f"   –¢–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞: {current_dir.name}")
        choice = input("   –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–∏? (y/n): ")
        if choice.lower() != 'y':
            project_root = current_dir
    
    # –ï—Å–ª–∏ pyproject.toml –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
    if project_root is None:
        project_root = current_dir
        print(f"‚ö†Ô∏è  Pyproject.toml –Ω–µ –Ω–∞–π–¥–µ–Ω, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é —Ç–µ–∫—É—â—É—é –ø–∞–ø–∫—É: {project_root}")
    
    # –°–æ–∑–¥–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_filename = f"PROJECT_EXPORT_{timestamp}.md"
    
    print(f"üìÇ –≠–∫—Å–ø–æ—Ä—Ç –∏–∑: {project_root}")
    print(f"üìÑ –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª: {output_filename}")
    print("‚è≥ –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —ç–∫—Å–ø–æ—Ä—Ç...")
    
    try:
        export_project(project_root, output_filename)
        print(f"‚úÖ –≠–∫—Å–ø–æ—Ä—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!")
        print(f"üìä –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –∫–∞–∫: {output_filename}")
        print("\nüìã –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ:")
        print(f"   1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –≤ VS Code: code {output_filename}")
        print(f"   2. –ò–ª–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –ª—é–±–æ–º Markdown-—Ä–µ–¥–∞–∫—Ç–æ—Ä–µ")
        print(f"   3. –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ: {e}")
        print("üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞:")
        print(f"   cd {project_root}")
        print("   python export_project_v2.py")
```

### üìÑ main.py
**–†–∞–∑–º–µ—Ä:** 2341 –±–∞–π—Ç  
```python
from kivy.lang import Builder
from kivymd.app import MDApp
from kivy.uix.screenmanager import ScreenManager
from kivy.core.window import Window 
from kivy.metrics import dp

from app.core.config import AppConfig
from app.core.database import DatabaseManager
from app.ui.screens.main_screen import MainScreen

class PlantProtectionApp(MDApp):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.config = AppConfig()
        self.db = DatabaseManager()
        self.screen_manager = None

    def build(self):
        Window.size = (dp(390), dp(640))
        self.theme_cls.primary_palette = "Green"
        self.theme_cls.theme_style = "Light"
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
        self._initialize_components()
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        return self._create_interface()

    def _initialize_components(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
        try:
            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            self.db.initialize()
            print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞")
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: {e}")

    def _create_interface(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
        self.screen_manager = ScreenManager()
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
        main_screen = MainScreen(name='main')
        self.screen_manager.add_widget(main_screen)
        
        return self.screen_manager

    # –ú–µ—Ç–æ–¥—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    def open_diagnosis(self):
        print("üì∑ –û—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π")
    
    def open_catalog(self):
        print("üìö –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤")
    
    def open_orders(self):
        print("üõí –û—Ç–∫—Ä—ã—Ç—å –∑–∞–∫–∞–∑—ã –∏ –∫–ª–∏–µ–Ω—Ç—ã")
    
    def open_settings(self):
        print("‚öôÔ∏è –û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏")
    
    def navigation_draw(self):
        print("üìã –û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏")

if __name__ == '__main__':
    PlantProtectionApp().run()
```

### üìÑ main_db_test.py
**–†–∞–∑–º–µ—Ä:** 6825 –±–∞–π—Ç  
```python
"""
–¢–ï–°–¢ –ë–ê–ó–´ –î–ê–ù–ù–´–• - –†–ê–ë–û–ß–ê–Ø –í–ï–†–°–ò–Ø
–≠—Ç—É –≤–µ—Ä—Å–∏—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ë–î –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç
"""

from kivy.app import App
from kivy.uix.boxlayout import BoxLayout
from kivy.uix.label import Label
from kivy.uix.button import Button
from pathlib import Path

from app.core.database_backup import DatabaseManagerBackup as DatabaseManager

class DatabaseTestApp(App):
    """
    –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ä–∞–±–æ—á–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    """
    
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.db = DatabaseManager()  # –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ—Å—Ç–æ–≤—É—é –≤–µ—Ä—Å–∏—é
        self.status_label = None
    
    def build(self):
        # –ì–ª–∞–≤–Ω—ã–π layout
        layout = BoxLayout(orientation='vertical', padding=20, spacing=20)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = Label(
            text='Plant Protection App - –¢–µ—Å—Ç –ë–î',
            font_size='24sp',
            size_hint_y=None,
            height=50
        )
        layout.add_widget(title)
        
        # –°—Ç–∞—Ç—É—Å
        self.status_label = Label(
            text='–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î',
            font_size='16sp',
            size_hint_y=None,
            height=100,
            text_size=(400, None)
        )
        layout.add_widget(self.status_label)
        
        # –ö–Ω–æ–ø–∫–∏
        btn_init = Button(
            text='1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ë–î',
            size_hint_y=None,
            height=50,
            on_press=self.initialize_database
        )
        layout.add_widget(btn_init)
        
        btn_check = Button(
            text='2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª –ë–î',
            size_hint_y=None,
            height=50,
            on_press=self.check_database_file
        )
        layout.add_widget(btn_check)
        
        btn_show = Button(
            text='3. –ü–æ–∫–∞–∑–∞—Ç—å –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π',
            size_hint_y=None,
            height=50,
            on_press=self.show_disease_classes
        )
        layout.add_widget(btn_show)
        
        btn_search = Button(
            text='4. –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤',
            size_hint_y=None,
            height=50,
            on_press=self.test_search
        )
        layout.add_widget(btn_search)
        
        btn_tables = Button(
            text='5. –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã',
            size_hint_y=None,
            height=50,
            on_press=self.show_tables_info
        )
        layout.add_widget(btn_tables)
        
        return layout
    
    def show_message(self, message):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å—Ç–∞—Ç—É—Å–µ"""
        if self.status_label:
            self.status_label.text = message
        print("üí¨", message)
    
    def check_database_file(self, instance=None):
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –ë–î"""
        try:
            db_path = Path(__file__).parent / "app" / "assets" / "database" / "plant_protection.db"
            exists = db_path.exists()
            size = db_path.stat().st_size if exists else 0
            
            if exists:
                self.show_message(f"‚úÖ –§–∞–π–ª –ë–î —Å—É—â–µ—Å—Ç–≤—É–µ—Ç\n–†–∞–∑–º–µ—Ä: {size} –±–∞–π—Ç\n–ü—É—Ç—å: {db_path}")
            else:
                self.show_message("‚ùå –§–∞–π–ª –ë–î –Ω–µ –Ω–∞–π–¥–µ–Ω")
        except Exception as e:
            self.show_message(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: {e}")
    
    def initialize_database(self, instance=None):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        try:
            success = self.db.initialize()
            if success:
                self.show_message("‚úÖ –ë–î —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞!")
                self.check_database_file()
            else:
                self.show_message("‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î")
        except Exception as e:
            error_msg = f"‚ùå –û—à–∏–±–∫–∞: {str(e)}"
            self.show_message(error_msg)
    
    def show_disease_classes(self, instance=None):
        """–ü–æ–∫–∞–∑–∞—Ç—å –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π"""
        try:
            classes = self.db.get_all_disease_classes()
            if classes:
                class_names = "\n".join([f"{cls[1]}: {cls[2]}" for cls in classes])
                self.show_message(f"–ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π:\n{class_names}")
            else:
                self.show_message("–ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
        except Exception as e:
            self.show_message(f"–û—à–∏–±–∫–∞: {e}")
    
    def test_search(self, instance=None):
        """–¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤"""
        try:
            results = self.db.search_pesticides("–ê–≥—Ä–æ—Ç–∏–Ω")
            if results:
                pesticide_names = "\n".join([f"{pest[1]} - {pest[5]} —Ä—É–±." for pest in results])
                self.show_message(f"–ù–∞–π–¥–µ–Ω—ã –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã:\n{pesticide_names}")
            else:
                self.show_message("–ü—Ä–µ–ø–∞—Ä–∞—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
        except Exception as e:
            self.show_message(f"–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞: {e}")
    
    def show_tables_info(self, instance=None):
        """–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö"""
        try:
            cursor = self.db.connection.cursor()
            
            # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
            cursor.execute("SELECT name FROM sqlite_master WHERE type='table'")
            tables = cursor.fetchall()
            
            table_info = []
            for table in tables:
                table_name = table[0]
                cursor.execute(f"SELECT COUNT(*) FROM {table_name}")
                count = cursor.fetchone()[0]
                table_info.append(f"{table_name}: {count} –∑–∞–ø–∏—Å–µ–π")
            
            self.show_message("–¢–∞–±–ª–∏—Ü—ã –≤ –ë–î:\n" + "\n".join(table_info))
            
        except Exception as e:
            self.show_message(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü: {e}")

if __name__ == '__main__':
    print("üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...")
    print("üíæ –≠—Ç–∞ –≤–µ—Ä—Å–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è")
    DatabaseTestApp().run()
```

### üìÑ pyproject.toml
**–†–∞–∑–º–µ—Ä:** 731 –±–∞–π—Ç  
```toml
[tool.poetry]
name = "plant-protection-app"
version = "0.1.0"
description = "My test version of mobile_plant_app"
authors = ["nell.fdorova.00@mail.ru"]
readme = ""  # –£–ë–†–ê–¢–¨ README.md
packages = [{include = "app"}]

# –î–æ–±–∞–≤—å—Ç–µ —ç—Ç—É —Å—Ç—Ä–æ–∫—É —á—Ç–æ–±—ã –æ—Ç–∫–ª—é—á–∏—Ç—å package mode:
package-mode = false

[tool.poetry.dependencies]
python = "^3.11"
kivy = "^2.3.0"
kivymd = "^1.1.1"
pillow = "^10.0.0"
opencv-python = "^4.8.0"
numpy = ">=1.24,<2"
pandas = "^2.0.0"
openpyxl = "^3.1.0"
sqlalchemy = "^2.0.0"

[tool.poetry.group.dev.dependencies]
pytest = "^7.0.0"
black = "^23.0.0"
flake8 = "^6.0.0"

[build-system]
requires = ["poetry-core"]
build-backend = "poetry-core.metadata"
```

### üìÑ app\README.txt
**–†–∞–∑–º–µ—Ä:** 1186 –±–∞–π—Ç  
```text
# –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Ä–∞–±–æ—á–µ–≥–æ –∫–æ–¥–∞

## üìÅ –§–∞–π–ª—ã —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π:

1. **`main_db_test.py`** - —Ç–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ë–î
2. **`app/core/database_backup.py`** - —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è DatabaseManager

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏:

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î:
```bash
python main_db_test.py

## –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—á–µ–π –ë–î:
### –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏–∑ database_backup.py –≤ database.py
### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ main_db_test.py –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

#–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ù–°
### –∫–ª–∞—Å—Å—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ù–° —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ \app\assets\disease_classes.txt
disease_classes.txt:
0 –ó–¥–æ—Ä–æ–≤–æ–µ_—Ä–∞—Å—Ç–µ–Ω–∏–µ
1 –ú—É—á–Ω–∏—Å—Ç–∞—è_—Ä–æ—Å–∞  
2 –ü–∞—Ä—à–∞
3 –†–∂–∞–≤—á–∏–Ω–∞
....
–í —ç—Ç–∏ –∫–ª–∞—Å—Å—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î.
–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å main.py
 –∏ –Ω–∞–∂–∞—Ç—å: –û–±–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. 
```

### üìÑ app\__init__.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

### üìÑ app\assets\disease_classes.txt
**–†–∞–∑–º–µ—Ä:** 321 –±–∞–π—Ç  
```text
0 –ó–¥–æ—Ä–æ–≤–æ–µ_—Ä–∞—Å—Ç–µ–Ω–∏–µ
1 –ú—É—á–Ω–∏—Å—Ç–∞—è_—Ä–æ—Å–∞  
2 –ü–∞—Ä—à–∞
3 –†–∂–∞–≤—á–∏–Ω–∞
4 –§–∏—Ç–æ—Ñ—Ç–æ—Ä–æ–∑
5 –ê–Ω—Ç—Ä–∞–∫–Ω–æ–∑
6 –ë–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è_–ø—è—Ç–Ω–∏—Å—Ç–æ—Å—Ç—å
7 –í–∏—Ä—É—Å_–º–æ–∑–∞–∏–∫–∏
8 –°–µ—Ä–∞—è_–≥–Ω–∏–ª—å
9 –ß–µ—Ä–Ω–∞—è_–ø—è—Ç–Ω–∏—Å—Ç–æ—Å—Ç—å
10 –í–µ—Ä—Ç–∏—Ü–∏–ª–ª–µ–∑
```

### üìÑ app\assets\models\plant_disease_model.tflite
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```

```

### üìÑ app\core\__init__.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

### üìÑ app\core\config.py
**–†–∞–∑–º–µ—Ä:** 1118 –±–∞–π—Ç  
```python
import os
from pathlib import Path

class AppConfig:
    """–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
    
    def __init__(self):
        self.app_name = "Plant Protection"
        self.version = "1.0.0"
        
        # –ü—É—Ç–∏ –∫ —Ä–µ—Å—É—Ä—Å–∞–º
        self.base_dir = Path(__file__).parent.parent.parent
        self.assets_dir = self.base_dir / "app" / "assets"
        self.models_dir = self.assets_dir / "models"
        self.database_dir = self.assets_dir / "database"
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        self.database_path = self.database_dir / "plant_protection.db"
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
        self._create_directories()
    
    def _create_directories(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π"""
        directories = [
            self.assets_dir,
            self.models_dir,
            self.database_dir
        ]
        
        for directory in directories:
            directory.mkdir(parents=True, exist_ok=True)
```

### üìÑ app\core\database.py
**–†–∞–∑–º–µ—Ä:** 14522 –±–∞–π—Ç  
```python
import sqlite3
from pathlib import Path
from app.core.config import AppConfig

class DatabaseManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö SQLite"""
    
    def __init__(self):
        # –ü—Ä—è–º–æ–π –ø—É—Ç—å –∫ –ë–î –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Config
        base_dir = Path(__file__).parent.parent.parent
        self.database_path = base_dir / "app" / "assets" / "database" / "plant_protection.db"
        self.connection = None
        
        # –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        self.database_path.parent.mkdir(parents=True, exist_ok=True)
    
    def initialize(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        try:
            self.connection = sqlite3.connect(self.database_path)
            self.connection.row_factory = sqlite3.Row
            self._create_tables()
            self._insert_sample_data()
            print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ")
            print(f"üìÅ –ü—É—Ç—å –∫ –ë–î: {self.database_path}")
            return True
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î: {e}")
            return False
    
    def _create_tables(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ö–µ–º–µ"""
        cursor = self.connection.cursor()
        
        # 1. –¢–∞–±–ª–∏—Ü–∞ —Ç–∏–ø–æ–≤ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_types (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                type_name TEXT NOT NULL UNIQUE
            )
        ''')
        
        # 2. –¢–∞–±–ª–∏—Ü–∞ –∫—É–ª—å—Ç—É—Ä
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS cultures (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                culture_name TEXT NOT NULL UNIQUE
            )
        ''')
        
        # 3. –¢–∞–±–ª–∏—Ü–∞ –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –≤–µ—â–µ—Å—Ç–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS active_substances (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                substance_name TEXT NOT NULL UNIQUE
            )
        ''')
        

        # 4. –¢–∞–±–ª–∏—Ü–∞ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è)
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS disease_classes (
                class_index INTEGER PRIMARY KEY,  -- –ò–Ω–¥–µ–∫—Å –∏–∑ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –∫–∞–∫ PRIMARY KEY
                class_name TEXT NOT NULL UNIQUE   -- –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è
            )
        ''')

        # 5. –¢–∞–±–ª–∏—Ü–∞ –±–æ–ª–µ–∑–Ω–µ–π —Ä–∞—Å—Ç–µ–Ω–∏–π
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS diseases (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                disease_name TEXT NOT NULL UNIQUE,
                symptoms TEXT,
                prevention_methods TEXT,
                culture_id INTEGER REFERENCES cultures(id),
                disease_class_index INTEGER REFERENCES disease_classes(class_index)  -- –ü—Ä–∏–≤—è–∑–∫–∞ –∫ class_index
            )
        ''')
        
        # 6. –¢–∞–±–ª–∏—Ü–∞ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticides (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                name TEXT NOT NULL,
                description TEXT,
                application_rate TEXT,
                packaging TEXT,
                price DECIMAL(10, 2),
                manufacturer TEXT,
                unit_of_measure TEXT,
                # image_url TEXT,
                pesticide_type_id INTEGER REFERENCES pesticide_types(id)
            )
        ''')
        
        # 7. –°–≤—è–∑—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã
        
        # –ü–µ—Å—Ç–∏—Ü–∏–¥—ã - –î–µ–π—Å—Ç–≤—É—é—â–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_active_substances (
                pesticide_id INTEGER REFERENCES pesticides(id),
                substance_id INTEGER REFERENCES active_substances(id),
                concentration TEXT,
                PRIMARY KEY (pesticide_id, substance_id)
            )
        ''')
        
        # –ü–µ—Å—Ç–∏—Ü–∏–¥—ã - –ö—É–ª—å—Ç—É—Ä—ã
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_cultures (
                pesticide_id INTEGER REFERENCES pesticides(id),
                culture_id INTEGER REFERENCES cultures(id),
                PRIMARY KEY (pesticide_id, culture_id)
            )
        ''')
        
        # –ü–µ—Å—Ç–∏—Ü–∏–¥—ã - –ë–æ–ª–µ–∑–Ω–∏
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_diseases (
                pesticide_id INTEGER REFERENCES pesticides(id),
                disease_id INTEGER REFERENCES diseases(id),
                PRIMARY KEY (pesticide_id, disease_id)
            )
        ''')
        
        # 8. –¢–∞–±–ª–∏—Ü–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS clients (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                client_name TEXT NOT NULL,
                contact_person TEXT,
                phone TEXT,
                email TEXT,
                total_orchard_area DECIMAL(10, 2),
                address TEXT,
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        # 9. –¢–∞–±–ª–∏—Ü–∞ –∫—É–ª—å—Ç—É—Ä –∫–ª–∏–µ–Ω—Ç–∞
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS client_cultures (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                client_id INTEGER REFERENCES clients(id),
                culture_id INTEGER REFERENCES cultures(id),
                area DECIMAL(10, 2),
                UNIQUE(client_id, culture_id)
            )
        ''')
        
        # 10. –¢–∞–±–ª–∏—Ü–∞ –∑–∞–∫–∞–∑–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS orders (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                order_number TEXT UNIQUE,
                client_id INTEGER REFERENCES clients(id),
                order_date DATE NOT NULL,
                shipment_date DATE,
                payment_date DATE,
                total_amount DECIMAL(12, 2),
                status TEXT DEFAULT '—á–µ—Ä–Ω–æ–≤–∏–∫',
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        # 11. –¢–∞–±–ª–∏—Ü–∞ –ø–æ–∑–∏—Ü–∏–π –∑–∞–∫–∞–∑–∞
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS order_items (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                order_id INTEGER REFERENCES orders(id),
                pesticide_id INTEGER REFERENCES pesticides(id),
                culture_id INTEGER REFERENCES cultures(id),
                quantity DECIMAL(10, 3),
                packaging TEXT,
                unit_price DECIMAL(10, 2),
                discount DECIMAL(5, 2) DEFAULT 0,
                discounted_price DECIMAL(10, 2),
                item_total DECIMAL(12, 2),
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        self.connection.commit()
        print("‚úÖ –¢–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω—ã")
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ —Ñ–∞–π–ª–∞
        self._load_disease_classes_from_file()
    
    def _insert_sample_data(self):
     """–í—Å—Ç–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö - –û–°–ù–û–í–ù–ê–Ø –í–ï–†–°–ò–Ø (–ø—É—Å—Ç–∞—è)"""
    # –í –æ—Å–Ω–æ–≤–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –Ω–µ –∑–∞–ø–æ–ª–Ω—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    # –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É –∏–ª–∏ –∏–º–ø–æ—Ä—Ç
    pass

    # –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
    
    def get_disease_class_by_index(self, class_index):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –ø–æ –∏–Ω–¥–µ–∫—Å—É –Ω–µ–π—Ä–æ—Å–µ—Ç–∏"""
        cursor = self.connection.cursor()
        cursor.execute('''
            SELECT * FROM disease_classes 
            WHERE class_index = ?
        ''', (class_index,))
        return cursor.fetchone()

    def get_all_disease_classes(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π"""
        cursor = self.connection.cursor()
        cursor.execute('''
            SELECT * FROM disease_classes 
            ORDER BY class_index
        ''')
        return cursor.fetchall()

    def update_disease_classes_from_file(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ —Ñ–∞–π–ª–∞"""
        print("üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π...")
        self._load_disease_classes_from_file()
        return True
   
    
    def get_recommendations_for_disease_class(self, class_index):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –∫–ª–∞—Å—Å–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è"""
        cursor = self.connection.cursor()
        cursor.execute('''
            SELECT p.* FROM pesticides p
            JOIN pesticide_diseases pd ON p.id = pd.pesticide_id
            JOIN diseases d ON pd.disease_id = d.id
            WHERE d.disease_class_id = ?
            LIMIT 10
        ''', (class_index,))
        return cursor.fetchall()
    
def search_pesticides(self, query, filters=None):
    """–ü–æ–∏—Å–∫ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏"""
    cursor = self.connection.cursor()
    
    sql = '''
        SELECT DISTINCT p.*
        FROM pesticides p
        LEFT JOIN pesticide_active_substances pas ON p.id = pas.pesticide_id
        LEFT JOIN active_substances as ON pas.substance_id = as.id
        LEFT JOIN pesticide_diseases pd ON p.id = pd.pesticide_id
        LEFT JOIN diseases d ON pd.disease_id = d.id
        WHERE (p.name LIKE ? OR as.substance_name LIKE ? OR d.disease_name LIKE ?)
    '''
    params = [f'%{query}%', f'%{query}%', f'%{query}%']
    
    cursor.execute(sql, params)
    return cursor.fetchall()
    
    def close(self):
        """–ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î"""
        if self.connection:
            self.connection.close()
def _load_disease_classes_from_file(self):
    """–ó–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ TXT —Ñ–∞–π–ª–∞"""
    try:
        # –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –∫–ª–∞—Å—Å–∞–º–∏
        classes_file = self.database_path.parent / "disease_classes.txt"
        
        if not classes_file.exists():
            print("‚ö†Ô∏è –§–∞–π–ª disease_classes.txt –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–ª–∞—Å—Å—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é")
            self._create_default_disease_classes()
            return
        
        cursor = self.connection.cursor()
        
        # –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        cursor.execute('DELETE FROM disease_classes')
        
        # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª
        with open(classes_file, 'r', encoding='utf-8') as f:
            for line in f:
                line = line.strip()
                if line and not line.startswith('#'):  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
                    parts = line.split(' ', 1)  # –†–∞–∑–¥–µ–ª—è–µ–º –ø–æ –ø–µ—Ä–≤–æ–º—É –ø—Ä–æ–±–µ–ª—É
                    if len(parts) == 2:
                        class_index = int(parts[0])
                        class_name = parts[1].replace('_', ' ')  # –ó–∞–º–µ–Ω—è–µ–º –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–±–µ–ª—ã
                        
                        cursor.execute('''
                            INSERT INTO disease_classes (class_index, class_name)
                            VALUES (?, ?)
                        ''', (class_index, class_name))
        
        self.connection.commit()
        print(f"‚úÖ –ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞: {classes_file.name}")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π: {e}")
        self._create_default_disease_classes()

def _create_default_disease_classes(self):
    """–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"""
    try:
        cursor = self.connection.cursor()
        
        default_classes = [
            (0, '–ó–¥–æ—Ä–æ–≤–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ'),
            (1, '–ú—É—á–Ω–∏—Å—Ç–∞—è —Ä–æ—Å–∞'),
            (2, '–ü–∞—Ä—à–∞'),
            (3, '–†–∂–∞–≤—á–∏–Ω–∞'),
            (4, '–§–∏—Ç–æ—Ñ—Ç–æ—Ä–æ–∑'),

# ... —Ñ–∞–π–ª –æ–±—Ä–µ–∑–∞–Ω, –ø–æ–∫–∞–∑–∞–Ω–æ 1000 –∏–∑ 3148 —Å—Ç—Ä–æ–∫ ...
```

### üìÑ PROJECT_EXPORT_20251206_132901.md
**–†–∞–∑–º–µ—Ä:** 39587 –±–∞–π—Ç  
```markdown
# –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–µ–∫—Ç–∞: plant_protection_app
**–î–∞—Ç–∞:** 2025-12-06 13:29:01
**–ü—É—Ç—å:** C:\Users\–ù–µ–ª–ª–∏\Desktop\file_for_run_python\plant_protection_app

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
  PROJECT_EXPORT_20251201_185440.md
  PROJECT_EXPORT_20251206_132901.md
  export_project_v1.py
  main.py
  main_db_test.py
  pyproject.toml
  app/
    README.txt
    __init__.py
    assets/
      disease_classes.txt
      database/
      fonts/
      models/
        plant_disease_model.tflite
    core/
      __init__.py
      config.py
      database.py
      database_backup.py
      test_data.py
    ml/
      __init__.py
      image_processor.py
      model_loader.py
    ui/
      __init__.py
      screens/
        __init__.py
        camera_screen.py
        catalog_screen.py
        disease_detection_screen.py
        main_screen.py
        orders_screen.py
        results_screen.py
        settings_screen.py
      widgets/
        __init__.py
        custom_buttons.py
        image_widgets.py
  resources/
  tests/
    __init__.py
    test_basic.py
```

## –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤

### üìÑ PROJECT_EXPORT_20251201_185440.md
**–†–∞–∑–º–µ—Ä:** 119681 –±–∞–π—Ç  
```markdown
# –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–µ–∫—Ç–∞: plant_protection_app
**–î–∞—Ç–∞:** 2025-12-01 18:54:40
**–ü—É—Ç—å:** C:\Users\–ù–µ–ª–ª–∏\Desktop\file_for_run_python\plant_protection_app

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
  PROJECT_EXPORT_20251201_185440.md
  export_project_v1.py
  main.py
  main_db_test.py
  pyproject.toml
  app/
    README.txt
    __init__.py
    assets/
      disease_classes.txt
      database/
      fonts/
      models/
        plant_disease_model.tflite
    core/
      __init__.py
      config.py
      database.py
      database_backup.py
      test_data.py
    ml/
      __init__.py
      image_processor.py
      model_loader.py
    ui/
      __init__.py
      screens/
        __init__.py
        camera_screen.py
        catalog_screen.py
        disease_detection_screen.py
        main_screen.py
        orders_screen.py
        results_screen.py
        settings_screen.py
      widgets/
        __init__.py
        custom_buttons.py
        image_widgets.py
  resources/
  tests/
    __init__.py
    test_basic.py
```

## –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤

### üìÑ PROJECT_EXPORT_20251201_185440.md
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```markdown

```

### üìÑ export_project_v1.py
**–†–∞–∑–º–µ—Ä:** 10701 –±–∞–π—Ç  
```python
import os
import pathlib
from datetime import datetime

def export_project(root_path=".", output_file="project_export.md"):
    """
    –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –æ–¥–∏–Ω Markdown —Ñ–∞–π–ª.
    """
    
    # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è
    exclude_dirs = {
        '.git', '__pycache__', '.pytest_cache', '.mypy_cache',
        'venv', '.venv', 'env', '.env', 'envs',
        '.vscode', '.idea', 'vs_code',
        'dist', 'build', '*.egg-info',
        'node_modules', 'coverage', '.coverage',
        '.github', '.gitlab', '.bitbucket',
        'poetry_env', 'virtual_env'  # –¥–æ–±–∞–≤–∏–ª —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è poetry
    }
    
    # –§–∞–π–ª—ã –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è
    exclude_files = {
        '*.pyc', '*.pyo', '*.pyd', '*.so',
        '*.db', '*.sqlite', '*.sqlite3', '*.log',
        'poetry.lock', 'package-lock.json', 'yarn.lock',
        '.gitignore', '.env', '.env.local', '.env.*',
        'Thumbs.db', 'desktop.ini'
    }
    
    root_path = pathlib.Path(root_path).resolve()
    
    with open(output_file, 'w', encoding='utf-8') as out:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        out.write(f"# –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–µ–∫—Ç–∞: {root_path.name}\n")
        out.write(f"**–î–∞—Ç–∞:** {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        out.write(f"**–ü—É—Ç—å:** {root_path}\n\n")
        
        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
        out.write("## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞\n\n")
        out.write("```\n")
        
        # –°–Ω–∞—á–∞–ª–∞ —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
        structure_lines = []
        
        for root, dirs, files in os.walk(root_path):
            # –§–∏–ª—å—Ç—Ä—É–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
            dirs[:] = [
                d for d in dirs 
                if d not in exclude_dirs 
                and not d.startswith('.')
                and not d.endswith('__pycache__')
            ]
            
            # –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å
            try:
                rel_root = pathlib.Path(root).relative_to(root_path)
            except ValueError:
                continue
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ—Ç—Å—Ç—É–ø
            if str(rel_root) == '.':
                indent_level = 0
            else:
                indent_level = len(rel_root.parts)
            
            indent = "  " * indent_level
            
            if str(rel_root) != '.':
                structure_lines.append(f"{indent}{rel_root.name}/")
            
            # –§–∞–π–ª—ã
            for file in sorted(files):
                if any(file.endswith(ext.strip('*')) for ext in exclude_files if '*' in ext):
                    continue
                if file in exclude_files:
                    continue
                if any(file == pattern for pattern in exclude_files):
                    continue
                    
                structure_lines.append(f"{indent}  {file}")
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
        for line in structure_lines:
            out.write(f"{line}\n")
        
        out.write("```\n\n")
        
        # –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤
        out.write("## –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤\n\n")
        
        file_count = 0
        total_size = 0
        excluded_count = 0
        
        for root, dirs, files in os.walk(root_path):
            # –§–∏–ª—å—Ç—Ä—É–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
            dirs[:] = [
                d for d in dirs 
                if d not in exclude_dirs 
                and not d.startswith('.')
                and not d.endswith('__pycache__')
            ]
            
            for file in sorted(files):
                file_path = pathlib.Path(root) / file
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —Ñ–∞–π–ª–æ–≤
                skip = False
                
                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é (—à–∞–±–ª–æ–Ω—ã —Ç–∏–ø–∞ *.pyc)
                for pattern in exclude_files:
                    if pattern.startswith('*'):
                        ext = pattern[1:]  # —É–±–∏—Ä–∞–µ–º –∑–≤–µ–∑–¥–æ—á–∫—É
                        if file.endswith(ext):
                            excluded_count += 1
                            skip = True
                            break
                    elif file == pattern:
                        excluded_count += 1
                        skip = True
                        break
                
                if skip:
                    continue
                
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
                if file.startswith('.'):
                    excluded_count += 1
                    continue
                
                try:
                    rel_path = file_path.relative_to(root_path)
                except ValueError:
                    continue
                
                # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–∑—ã–∫ –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
                ext = file_path.suffix.lower()
                lang_map = {
                    '.py': 'python',
                    '.js': 'javascript',
                    '.ts': 'typescript',
                    '.html': 'html',
                    '.css': 'css',
                    '.md': 'markdown',
                    '.json': 'json',
                    '.yml': 'yaml',
                    '.yaml': 'yaml',
                    '.txt': 'text',
                    '.toml': 'toml',
                    '.ini': 'ini',
                    '.xml': 'xml',
                    '.csv': 'csv',
                    '.sql': 'sql',
                }
                lang = lang_map.get(ext, '')
                
                out.write(f"### üìÑ {rel_path}\n")
                out.write(f"**–†–∞–∑–º–µ—Ä:** {file_path.stat().st_size} –±–∞–π—Ç  \n")
                
                try:
                    # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ä–∞–∑–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫
                    try:
                        content = file_path.read_text(encoding='utf-8')
                    except UnicodeDecodeError:
                        try:
                            content = file_path.read_text(encoding='cp1251')
                        except:
                            content = f"# –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª (–±–∏–Ω–∞—Ä–Ω—ã–π –∏–ª–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞)\n"
                    
                    # –û–±—Ä–µ–∑–∞–µ–º —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã
                    max_lines = 1000
                    lines = content.split('\n')
                    if len(lines) > max_lines:
                        content = '\n'.join(lines[:max_lines])
                        content += f"\n\n# ... —Ñ–∞–π–ª –æ–±—Ä–µ–∑–∞–Ω, –ø–æ–∫–∞–∑–∞–Ω–æ {max_lines} –∏–∑ {len(lines)} —Å—Ç—Ä–æ–∫ ..."
                    
                    out.write(f"```{lang}\n")
                    out.write(content)
                    if not content.endswith('\n'):
                        out.write('\n')
                    out.write("```\n\n")
                    
                    file_count += 1
                    total_size += file_path.stat().st_size
                    
                except Exception as e:
                    out.write(f"```\n# –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: {e}\n```\n\n")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        out.write("## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n\n")
        out.write(f"- **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** {file_count}\n")
        out.write(f"- **–ò—Å–∫–ª—é—á–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** {excluded_count}\n")
        out.write(f"- **–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä:** {total_size} –±–∞–π—Ç ({total_size/1024:.2f} KB)\n")
        out.write(f"- **–î–∞—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞:** {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")

if __name__ == "__main__":
    print("üîç –ü–æ–∏—Å–∫ –∫–æ—Ä–Ω—è Poetry –ø—Ä–æ–µ–∫—Ç–∞...")
    current_dir = pathlib.Path.cwd()
    
    # –ò—â–µ–º pyproject.toml –≤ —Ç–µ–∫—É—â–µ–π –∏–ª–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    project_root = None
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
    if (current_dir / "pyproject.toml").exists():
        project_root = current_dir
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω Poetry –ø—Ä–æ–µ–∫—Ç –≤ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ: {project_root}")
    
    # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏, –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é
    elif (current_dir.parent / "pyproject.toml").exists():
        project_root = current_dir.parent
        print(f"‚ö†Ô∏è  Pyproject.toml –Ω–∞–π–¥–µ–Ω –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–µ: {project_root}")
        print(f"   –¢–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞: {current_dir.name}")
        choice = input("   –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–∏? (y/n): ")
        if choice.lower() != 'y':
            project_root = current_dir
    
    # –ï—Å–ª–∏ pyproject.toml –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
    if project_root is None:
        project_root = current_dir
        print(f"‚ö†Ô∏è  Pyproject.toml –Ω–µ –Ω–∞–π–¥–µ–Ω, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é —Ç–µ–∫—É—â—É—é –ø–∞–ø–∫—É: {project_root}")
    
    # –°–æ–∑–¥–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_filename = f"PROJECT_EXPORT_{timestamp}.md"
    
    print(f"üìÇ –≠–∫—Å–ø–æ—Ä—Ç –∏–∑: {project_root}")
    print(f"üìÑ –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª: {output_filename}")
    print("‚è≥ –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —ç–∫—Å–ø–æ—Ä—Ç...")
    
    try:
        export_project(project_root, output_filename)
        print(f"‚úÖ –≠–∫—Å–ø–æ—Ä—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!")
        print(f"üìä –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –∫–∞–∫: {output_filename}")
        print("\nüìã –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ:")
        print(f"   1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –≤ VS Code: code {output_filename}")
        print(f"   2. –ò–ª–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –ª—é–±–æ–º Markdown-—Ä–µ–¥–∞–∫—Ç–æ—Ä–µ")
        print(f"   3. –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ: {e}")
        print("üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞:")
        print(f"   cd {project_root}")
        print("   python export_project_v2.py")
```

### üìÑ main.py
**–†–∞–∑–º–µ—Ä:** 2341 –±–∞–π—Ç  
```python
from kivy.lang import Builder
from kivymd.app import MDApp
from kivy.uix.screenmanager import ScreenManager
from kivy.core.window import Window 
from kivy.metrics import dp

from app.core.config import AppConfig
from app.core.database import DatabaseManager
from app.ui.screens.main_screen import MainScreen

class PlantProtectionApp(MDApp):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.config = AppConfig()
        self.db = DatabaseManager()
        self.screen_manager = None

    def build(self):
        Window.size = (dp(390), dp(640))
        self.theme_cls.primary_palette = "Green"
        self.theme_cls.theme_style = "Light"
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
        self._initialize_components()
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        return self._create_interface()

    def _initialize_components(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
        try:
            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            self.db.initialize()
            print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞")
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: {e}")

    def _create_interface(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
        self.screen_manager = ScreenManager()
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
        main_screen = MainScreen(name='main')
        self.screen_manager.add_widget(main_screen)
        
        return self.screen_manager

    # –ú–µ—Ç–æ–¥—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    def open_diagnosis(self):
        print("üì∑ –û—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π")
    
    def open_catalog(self):
        print("üìö –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤")
    
    def open_orders(self):
        print("üõí –û—Ç–∫—Ä—ã—Ç—å –∑–∞–∫–∞–∑—ã –∏ –∫–ª–∏–µ–Ω—Ç—ã")
    
    def open_settings(self):
        print("‚öôÔ∏è –û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏")
    
    def navigation_draw(self):
        print("üìã –û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏")

if __name__ == '__main__':
    PlantProtectionApp().run()
```

### üìÑ main_db_test.py
**–†–∞–∑–º–µ—Ä:** 6825 –±–∞–π—Ç  
```python
"""
–¢–ï–°–¢ –ë–ê–ó–´ –î–ê–ù–ù–´–• - –†–ê–ë–û–ß–ê–Ø –í–ï–†–°–ò–Ø
–≠—Ç—É –≤–µ—Ä—Å–∏—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ë–î –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç
"""

from kivy.app import App
from kivy.uix.boxlayout import BoxLayout
from kivy.uix.label import Label
from kivy.uix.button import Button
from pathlib import Path

from app.core.database_backup import DatabaseManagerBackup as DatabaseManager

class DatabaseTestApp(App):
    """
    –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ä–∞–±–æ—á–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    """
    
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.db = DatabaseManager()  # –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ—Å—Ç–æ–≤—É—é –≤–µ—Ä—Å–∏—é
        self.status_label = None
    
    def build(self):
        # –ì–ª–∞–≤–Ω—ã–π layout
        layout = BoxLayout(orientation='vertical', padding=20, spacing=20)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = Label(
            text='Plant Protection App - –¢–µ—Å—Ç –ë–î',
            font_size='24sp',
            size_hint_y=None,
            height=50
        )
        layout.add_widget(title)
        
        # –°—Ç–∞—Ç—É—Å
        self.status_label = Label(
            text='–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î',
            font_size='16sp',
            size_hint_y=None,
            height=100,
            text_size=(400, None)
        )
        layout.add_widget(self.status_label)
        
        # –ö–Ω–æ–ø–∫–∏
        btn_init = Button(
            text='1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ë–î',
            size_hint_y=None,
            height=50,
            on_press=self.initialize_database
        )
        layout.add_widget(btn_init)
        
        btn_check = Button(
            text='2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª –ë–î',
            size_hint_y=None,
            height=50,
            on_press=self.check_database_file
        )
        layout.add_widget(btn_check)
        
        btn_show = Button(
            text='3. –ü–æ–∫–∞–∑–∞—Ç—å –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π',
            size_hint_y=None,
            height=50,
            on_press=self.show_disease_classes
        )
        layout.add_widget(btn_show)
        
        btn_search = Button(
            text='4. –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤',
            size_hint_y=None,
            height=50,
            on_press=self.test_search
        )
        layout.add_widget(btn_search)
        
        btn_tables = Button(
            text='5. –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã',
            size_hint_y=None,
            height=50,
            on_press=self.show_tables_info
        )
        layout.add_widget(btn_tables)
        
        return layout
    
    def show_message(self, message):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å—Ç–∞—Ç—É—Å–µ"""
        if self.status_label:
            self.status_label.text = message
        print("üí¨", message)
    
    def check_database_file(self, instance=None):
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –ë–î"""
        try:
            db_path = Path(__file__).parent / "app" / "assets" / "database" / "plant_protection.db"
            exists = db_path.exists()
            size = db_path.stat().st_size if exists else 0
            
            if exists:
                self.show_message(f"‚úÖ –§–∞–π–ª –ë–î —Å—É—â–µ—Å—Ç–≤—É–µ—Ç\n–†–∞–∑–º–µ—Ä: {size} –±–∞–π—Ç\n–ü—É—Ç—å: {db_path}")
            else:
                self.show_message("‚ùå –§–∞–π–ª –ë–î –Ω–µ –Ω–∞–π–¥–µ–Ω")
        except Exception as e:
            self.show_message(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: {e}")
    
    def initialize_database(self, instance=None):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        try:
            success = self.db.initialize()
            if success:
                self.show_message("‚úÖ –ë–î —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞!")
                self.check_database_file()
            else:
                self.show_message("‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î")
        except Exception as e:
            error_msg = f"‚ùå –û—à–∏–±–∫–∞: {str(e)}"
            self.show_message(error_msg)
    
    def show_disease_classes(self, instance=None):
        """–ü–æ–∫–∞–∑–∞—Ç—å –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π"""
        try:
            classes = self.db.get_all_disease_classes()
            if classes:
                class_names = "\n".join([f"{cls[1]}: {cls[2]}" for cls in classes])
                self.show_message(f"–ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π:\n{class_names}")
            else:
                self.show_message("–ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
        except Exception as e:
            self.show_message(f"–û—à–∏–±–∫–∞: {e}")
    
    def test_search(self, instance=None):
        """–¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤"""
        try:
            results = self.db.search_pesticides("–ê–≥—Ä–æ—Ç–∏–Ω")
            if results:
                pesticide_names = "\n".join([f"{pest[1]} - {pest[5]} —Ä—É–±." for pest in results])
                self.show_message(f"–ù–∞–π–¥–µ–Ω—ã –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã:\n{pesticide_names}")
            else:
                self.show_message("–ü—Ä–µ–ø–∞—Ä–∞—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
        except Exception as e:
            self.show_message(f"–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞: {e}")
    
    def show_tables_info(self, instance=None):
        """–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö"""
        try:
            cursor = self.db.connection.cursor()
            
            # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
            cursor.execute("SELECT name FROM sqlite_master WHERE type='table'")
            tables = cursor.fetchall()
            
            table_info = []
            for table in tables:
                table_name = table[0]
                cursor.execute(f"SELECT COUNT(*) FROM {table_name}")
                count = cursor.fetchone()[0]
                table_info.append(f"{table_name}: {count} –∑–∞–ø–∏—Å–µ–π")
            
            self.show_message("–¢–∞–±–ª–∏—Ü—ã –≤ –ë–î:\n" + "\n".join(table_info))
            
        except Exception as e:
            self.show_message(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü: {e}")

if __name__ == '__main__':
    print("üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...")
    print("üíæ –≠—Ç–∞ –≤–µ—Ä—Å–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è")
    DatabaseTestApp().run()
```

### üìÑ pyproject.toml
**–†–∞–∑–º–µ—Ä:** 731 –±–∞–π—Ç  
```toml
[tool.poetry]
name = "plant-protection-app"
version = "0.1.0"
description = "My test version of mobile_plant_app"
authors = ["nell.fdorova.00@mail.ru"]
readme = ""  # –£–ë–†–ê–¢–¨ README.md
packages = [{include = "app"}]

# –î–æ–±–∞–≤—å—Ç–µ —ç—Ç—É —Å—Ç—Ä–æ–∫—É —á—Ç–æ–±—ã –æ—Ç–∫–ª—é—á–∏—Ç—å package mode:
package-mode = false

[tool.poetry.dependencies]
python = "^3.11"
kivy = "^2.3.0"
kivymd = "^1.1.1"
pillow = "^10.0.0"
opencv-python = "^4.8.0"
numpy = ">=1.24,<2"
pandas = "^2.0.0"
openpyxl = "^3.1.0"
sqlalchemy = "^2.0.0"

[tool.poetry.group.dev.dependencies]
pytest = "^7.0.0"
black = "^23.0.0"
flake8 = "^6.0.0"

[build-system]
requires = ["poetry-core"]
build-backend = "poetry-core.metadata"
```

### üìÑ app\README.txt
**–†–∞–∑–º–µ—Ä:** 1186 –±–∞–π—Ç  
```text
# –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Ä–∞–±–æ—á–µ–≥–æ –∫–æ–¥–∞

## üìÅ –§–∞–π–ª—ã —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π:

1. **`main_db_test.py`** - —Ç–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ë–î
2. **`app/core/database_backup.py`** - —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è DatabaseManager

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏:

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î:
```bash
python main_db_test.py

## –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—á–µ–π –ë–î:
### –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏–∑ database_backup.py –≤ database.py
### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ main_db_test.py –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

#–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ù–°
### –∫–ª–∞—Å—Å—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ù–° —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ \app\assets\disease_classes.txt
disease_classes.txt:
0 –ó–¥–æ—Ä–æ–≤–æ–µ_—Ä–∞—Å—Ç–µ–Ω–∏–µ
1 –ú—É—á–Ω–∏—Å—Ç–∞—è_—Ä–æ—Å–∞  
2 –ü–∞—Ä—à–∞
3 –†–∂–∞–≤—á–∏–Ω–∞
....
–í —ç—Ç–∏ –∫–ª–∞—Å—Å—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î.
–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å main.py
 –∏ –Ω–∞–∂–∞—Ç—å: –û–±–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. 
```

### üìÑ app\__init__.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

### üìÑ app\assets\disease_classes.txt
**–†–∞–∑–º–µ—Ä:** 321 –±–∞–π—Ç  
```text
0 –ó–¥–æ—Ä–æ–≤–æ–µ_—Ä–∞—Å—Ç–µ–Ω–∏–µ
1 –ú—É—á–Ω–∏—Å—Ç–∞—è_—Ä–æ—Å–∞  
2 –ü–∞—Ä—à–∞
3 –†–∂–∞–≤—á–∏–Ω–∞
4 –§–∏—Ç–æ—Ñ—Ç–æ—Ä–æ–∑
5 –ê–Ω—Ç—Ä–∞–∫–Ω–æ–∑
6 –ë–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è_–ø—è—Ç–Ω–∏—Å—Ç–æ—Å—Ç—å
7 –í–∏—Ä—É—Å_–º–æ–∑–∞–∏–∫–∏
8 –°–µ—Ä–∞—è_–≥–Ω–∏–ª—å
9 –ß–µ—Ä–Ω–∞—è_–ø—è—Ç–Ω–∏—Å—Ç–æ—Å—Ç—å
10 –í–µ—Ä—Ç–∏—Ü–∏–ª–ª–µ–∑
```

### üìÑ app\assets\models\plant_disease_model.tflite
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```

```

### üìÑ app\core\__init__.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

### üìÑ app\core\config.py
**–†–∞–∑–º–µ—Ä:** 1118 –±–∞–π—Ç  
```python
import os
from pathlib import Path

class AppConfig:
    """–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
    
    def __init__(self):
        self.app_name = "Plant Protection"
        self.version = "1.0.0"
        
        # –ü—É—Ç–∏ –∫ —Ä–µ—Å—É—Ä—Å–∞–º
        self.base_dir = Path(__file__).parent.parent.parent
        self.assets_dir = self.base_dir / "app" / "assets"
        self.models_dir = self.assets_dir / "models"
        self.database_dir = self.assets_dir / "database"
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        self.database_path = self.database_dir / "plant_protection.db"
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
        self._create_directories()
    
    def _create_directories(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π"""
        directories = [
            self.assets_dir,
            self.models_dir,
            self.database_dir
        ]
        
        for directory in directories:
            directory.mkdir(parents=True, exist_ok=True)
```

### üìÑ app\core\database.py
**–†–∞–∑–º–µ—Ä:** 14522 –±–∞–π—Ç  
```python
import sqlite3
from pathlib import Path
from app.core.config import AppConfig

class DatabaseManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö SQLite"""
    
    def __init__(self):
        # –ü—Ä—è–º–æ–π –ø—É—Ç—å –∫ –ë–î –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Config
        base_dir = Path(__file__).parent.parent.parent
        self.database_path = base_dir / "app" / "assets" / "database" / "plant_protection.db"
        self.connection = None
        
        # –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        self.database_path.parent.mkdir(parents=True, exist_ok=True)
    
    def initialize(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        try:
            self.connection = sqlite3.connect(self.database_path)
            self.connection.row_factory = sqlite3.Row
            self._create_tables()
            self._insert_sample_data()
            print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ")
            print(f"üìÅ –ü—É—Ç—å –∫ –ë–î: {self.database_path}")
            return True
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î: {e}")
            return False
    
    def _create_tables(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ö–µ–º–µ"""
        cursor = self.connection.cursor()
        
        # 1. –¢–∞–±–ª–∏—Ü–∞ —Ç–∏–ø–æ–≤ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_types (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                type_name TEXT NOT NULL UNIQUE
            )
        ''')
        
        # 2. –¢–∞–±–ª–∏—Ü–∞ –∫—É–ª—å—Ç—É—Ä
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS cultures (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                culture_name TEXT NOT NULL UNIQUE
            )
        ''')
        
        # 3. –¢–∞–±–ª–∏—Ü–∞ –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –≤–µ—â–µ—Å—Ç–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS active_substances (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                substance_name TEXT NOT NULL UNIQUE
            )
        ''')
        

        # 4. –¢–∞–±–ª–∏—Ü–∞ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è)
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS disease_classes (
                class_index INTEGER PRIMARY KEY,  -- –ò–Ω–¥–µ–∫—Å –∏–∑ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –∫–∞–∫ PRIMARY KEY
                class_name TEXT NOT NULL UNIQUE   -- –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è
            )
        ''')

        # 5. –¢–∞–±–ª–∏—Ü–∞ –±–æ–ª–µ–∑–Ω–µ–π —Ä–∞—Å—Ç–µ–Ω–∏–π
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS diseases (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                disease_name TEXT NOT NULL UNIQUE,
                symptoms TEXT,
                prevention_methods TEXT,
                culture_id INTEGER REFERENCES cultures(id),
                disease_class_index INTEGER REFERENCES disease_classes(class_index)  -- –ü—Ä–∏–≤—è–∑–∫–∞ –∫ class_index
            )
        ''')
        
        # 6. –¢–∞–±–ª–∏—Ü–∞ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticides (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                name TEXT NOT NULL,
                description TEXT,
                application_rate TEXT,
                packaging TEXT,
                price DECIMAL(10, 2),
                manufacturer TEXT,
                unit_of_measure TEXT,
                # image_url TEXT,
                pesticide_type_id INTEGER REFERENCES pesticide_types(id)
            )
        ''')
        
        # 7. –°–≤—è–∑—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã
        
        # –ü–µ—Å—Ç–∏—Ü–∏–¥—ã - –î–µ–π—Å—Ç–≤—É—é—â–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_active_substances (
                pesticide_id INTEGER REFERENCES pesticides(id),
                substance_id INTEGER REFERENCES active_substances(id),
                concentration TEXT,
                PRIMARY KEY (pesticide_id, substance_id)
            )
        ''')
        
        # –ü–µ—Å—Ç–∏—Ü–∏–¥—ã - –ö—É–ª—å—Ç—É—Ä—ã
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_cultures (
                pesticide_id INTEGER REFERENCES pesticides(id),
                culture_id INTEGER REFERENCES cultures(id),
                PRIMARY KEY (pesticide_id, culture_id)
            )
        ''')
        
        # –ü–µ—Å—Ç–∏—Ü–∏–¥—ã - –ë–æ–ª–µ–∑–Ω–∏
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_diseases (
                pesticide_id INTEGER REFERENCES pesticides(id),
                disease_id INTEGER REFERENCES diseases(id),
                PRIMARY KEY (pesticide_id, disease_id)
            )
        ''')
        
        # 8. –¢–∞–±–ª–∏—Ü–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS clients (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                client_name TEXT NOT NULL,
                contact_person TEXT,
                phone TEXT,
                email TEXT,
                total_orchard_area DECIMAL(10, 2),
                address TEXT,
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        # 9. –¢–∞–±–ª–∏—Ü–∞ –∫—É–ª—å—Ç—É—Ä –∫–ª–∏–µ–Ω—Ç–∞
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS client_cultures (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                client_id INTEGER REFERENCES clients(id),
                culture_id INTEGER REFERENCES cultures(id),
                area DECIMAL(10, 2),
                UNIQUE(client_id, culture_id)
            )
        ''')
        
        # 10. –¢–∞–±–ª–∏—Ü–∞ –∑–∞–∫–∞–∑–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS orders (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                order_number TEXT UNIQUE,
                client_id INTEGER REFERENCES clients(id),
                order_date DATE NOT NULL,
                shipment_date DATE,
                payment_date DATE,
                total_amount DECIMAL(12, 2),
                status TEXT DEFAULT '—á–µ—Ä–Ω–æ–≤–∏–∫',
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        # 11. –¢–∞–±–ª–∏—Ü–∞ –ø–æ–∑–∏—Ü–∏–π –∑–∞–∫–∞–∑–∞
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS order_items (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                order_id INTEGER REFERENCES orders(id),
                pesticide_id INTEGER REFERENCES pesticides(id),
                culture_id INTEGER REFERENCES cultures(id),
                quantity DECIMAL(10, 3),
                packaging TEXT,
                unit_price DECIMAL(10, 2),
                discount DECIMAL(5, 2) DEFAULT 0,
                discounted_price DECIMAL(10, 2),
                item_total DECIMAL(12, 2),
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        self.connection.commit()
        print("‚úÖ –¢–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω—ã")
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ —Ñ–∞–π–ª–∞
        self._load_disease_classes_from_file()
    
    def _insert_sample_data(self):
     """–í—Å—Ç–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö - –û–°–ù–û–í–ù–ê–Ø –í–ï–†–°–ò–Ø (–ø—É—Å—Ç–∞—è)"""
    # –í –æ—Å–Ω–æ–≤–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –Ω–µ –∑–∞–ø–æ–ª–Ω—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    # –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É –∏–ª–∏ –∏–º–ø–æ—Ä—Ç
    pass

    # –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
    
    def get_disease_class_by_index(self, class_index):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –ø–æ –∏–Ω–¥–µ–∫—Å—É –Ω–µ–π—Ä–æ—Å–µ—Ç–∏"""
        cursor = self.connection.cursor()
        cursor.execute('''
            SELECT * FROM disease_classes 
            WHERE class_index = ?
        ''', (class_index,))
        return cursor.fetchone()

    def get_all_disease_classes(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π"""
        cursor = self.connection.cursor()
        cursor.execute('''
            SELECT * FROM disease_classes 
            ORDER BY class_index
        ''')
        return cursor.fetchall()

    def update_disease_classes_from_file(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ —Ñ–∞–π–ª–∞"""
        print("üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π...")
        self._load_disease_classes_from_file()
        return True
   
    
    def get_recommendations_for_disease_class(self, class_index):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –∫–ª–∞—Å—Å–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è"""
        cursor = self.connection.cursor()
        cursor.execute('''
            SELECT p.* FROM pesticides p
            JOIN pesticide_diseases pd ON p.id = pd.pesticide_id
            JOIN diseases d ON pd.disease_id = d.id
            WHERE d.disease_class_id = ?
            LIMIT 10
        ''', (class_index,))
        return cursor.fetchall()
    
def search_pesticides(self, query, filters=None):
    """–ü–æ–∏—Å–∫ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏"""
    cursor = self.connection.cursor()
    
    sql = '''
        SELECT DISTINCT p.*
        FROM pesticides p
        LEFT JOIN pesticide_active_substances pas ON p.id = pas.pesticide_id
        LEFT JOIN active_substances as ON pas.substance_id = as.id
        LEFT JOIN pesticide_diseases pd ON p.id = pd.pesticide_id
        LEFT JOIN diseases d ON pd.disease_id = d.id
        WHERE (p.name LIKE ? OR as.substance_name LIKE ? OR d.disease_name LIKE ?)
    '''

# ... —Ñ–∞–π–ª –æ–±—Ä–µ–∑–∞–Ω, –ø–æ–∫–∞–∑–∞–Ω–æ 1000 –∏–∑ 1060 —Å—Ç—Ä–æ–∫ ...
```

### üìÑ export_project_v1.py
**–†–∞–∑–º–µ—Ä:** 10701 –±–∞–π—Ç  
```python
import os
import pathlib
from datetime import datetime

def export_project(root_path=".", output_file="project_export.md"):
    """
    –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –æ–¥–∏–Ω Markdown —Ñ–∞–π–ª.
    """
    
    # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è
    exclude_dirs = {
        '.git', '__pycache__', '.pytest_cache', '.mypy_cache',
        'venv', '.venv', 'env', '.env', 'envs',
        '.vscode', '.idea', 'vs_code',
        'dist', 'build', '*.egg-info',
        'node_modules', 'coverage', '.coverage',
        '.github', '.gitlab', '.bitbucket',
        'poetry_env', 'virtual_env'  # –¥–æ–±–∞–≤–∏–ª —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è poetry
    }
    
    # –§–∞–π–ª—ã –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è
    exclude_files = {
        '*.pyc', '*.pyo', '*.pyd', '*.so',
        '*.db', '*.sqlite', '*.sqlite3', '*.log',
        'poetry.lock', 'package-lock.json', 'yarn.lock',
        '.gitignore', '.env', '.env.local', '.env.*',
        'Thumbs.db', 'desktop.ini'
    }
    
    root_path = pathlib.Path(root_path).resolve()
    
    with open(output_file, 'w', encoding='utf-8') as out:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        out.write(f"# –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–µ–∫—Ç–∞: {root_path.name}\n")
        out.write(f"**–î–∞—Ç–∞:** {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        out.write(f"**–ü—É—Ç—å:** {root_path}\n\n")
        
        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
        out.write("## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞\n\n")
        out.write("```\n")
        
        # –°–Ω–∞—á–∞–ª–∞ —Å–æ–±–∏—Ä–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
        structure_lines = []
        
        for root, dirs, files in os.walk(root_path):
            # –§–∏–ª—å—Ç—Ä—É–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
            dirs[:] = [
                d for d in dirs 
                if d not in exclude_dirs 
                and not d.startswith('.')
                and not d.endswith('__pycache__')
            ]
            
            # –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø—É—Ç—å
            try:
                rel_root = pathlib.Path(root).relative_to(root_path)
            except ValueError:
                continue
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ—Ç—Å—Ç—É–ø
            if str(rel_root) == '.':
                indent_level = 0
            else:
                indent_level = len(rel_root.parts)
            
            indent = "  " * indent_level
            
            if str(rel_root) != '.':
                structure_lines.append(f"{indent}{rel_root.name}/")
            
            # –§–∞–π–ª—ã
            for file in sorted(files):
                if any(file.endswith(ext.strip('*')) for ext in exclude_files if '*' in ext):
                    continue
                if file in exclude_files:
                    continue
                if any(file == pattern for pattern in exclude_files):
                    continue
                    
                structure_lines.append(f"{indent}  {file}")
        
        # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É
        for line in structure_lines:
            out.write(f"{line}\n")
        
        out.write("```\n\n")
        
        # –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤
        out.write("## –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–æ–≤\n\n")
        
        file_count = 0
        total_size = 0
        excluded_count = 0
        
        for root, dirs, files in os.walk(root_path):
            # –§–∏–ª—å—Ç—Ä—É–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
            dirs[:] = [
                d for d in dirs 
                if d not in exclude_dirs 
                and not d.startswith('.')
                and not d.endswith('__pycache__')
            ]
            
            for file in sorted(files):
                file_path = pathlib.Path(root) / file
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è —Ñ–∞–π–ª–æ–≤
                skip = False
                
                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é (—à–∞–±–ª–æ–Ω—ã —Ç–∏–ø–∞ *.pyc)
                for pattern in exclude_files:
                    if pattern.startswith('*'):
                        ext = pattern[1:]  # —É–±–∏—Ä–∞–µ–º –∑–≤–µ–∑–¥–æ—á–∫—É
                        if file.endswith(ext):
                            excluded_count += 1
                            skip = True
                            break
                    elif file == pattern:
                        excluded_count += 1
                        skip = True
                        break
                
                if skip:
                    continue
                
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
                if file.startswith('.'):
                    excluded_count += 1
                    continue
                
                try:
                    rel_path = file_path.relative_to(root_path)
                except ValueError:
                    continue
                
                # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–∑—ã–∫ –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
                ext = file_path.suffix.lower()
                lang_map = {
                    '.py': 'python',
                    '.js': 'javascript',
                    '.ts': 'typescript',
                    '.html': 'html',
                    '.css': 'css',
                    '.md': 'markdown',
                    '.json': 'json',
                    '.yml': 'yaml',
                    '.yaml': 'yaml',
                    '.txt': 'text',
                    '.toml': 'toml',
                    '.ini': 'ini',
                    '.xml': 'xml',
                    '.csv': 'csv',
                    '.sql': 'sql',
                }
                lang = lang_map.get(ext, '')
                
                out.write(f"### üìÑ {rel_path}\n")
                out.write(f"**–†–∞–∑–º–µ—Ä:** {file_path.stat().st_size} –±–∞–π—Ç  \n")
                
                try:
                    # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ä–∞–∑–Ω—ã—Ö –∫–æ–¥–∏—Ä–æ–≤–æ–∫
                    try:
                        content = file_path.read_text(encoding='utf-8')
                    except UnicodeDecodeError:
                        try:
                            content = file_path.read_text(encoding='cp1251')
                        except:
                            content = f"# –ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª (–±–∏–Ω–∞—Ä–Ω—ã–π –∏–ª–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞)\n"
                    
                    # –û–±—Ä–µ–∑–∞–µ–º —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã
                    max_lines = 1000
                    lines = content.split('\n')
                    if len(lines) > max_lines:
                        content = '\n'.join(lines[:max_lines])
                        content += f"\n\n# ... —Ñ–∞–π–ª –æ–±—Ä–µ–∑–∞–Ω, –ø–æ–∫–∞–∑–∞–Ω–æ {max_lines} –∏–∑ {len(lines)} —Å—Ç—Ä–æ–∫ ..."
                    
                    out.write(f"```{lang}\n")
                    out.write(content)
                    if not content.endswith('\n'):
                        out.write('\n')
                    out.write("```\n\n")
                    
                    file_count += 1
                    total_size += file_path.stat().st_size
                    
                except Exception as e:
                    out.write(f"```\n# –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞: {e}\n```\n\n")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        out.write("## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞\n\n")
        out.write(f"- **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** {file_count}\n")
        out.write(f"- **–ò—Å–∫–ª—é—á–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** {excluded_count}\n")
        out.write(f"- **–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä:** {total_size} –±–∞–π—Ç ({total_size/1024:.2f} KB)\n")
        out.write(f"- **–î–∞—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞:** {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")

if __name__ == "__main__":
    print("üîç –ü–æ–∏—Å–∫ –∫–æ—Ä–Ω—è Poetry –ø—Ä–æ–µ–∫—Ç–∞...")
    current_dir = pathlib.Path.cwd()
    
    # –ò—â–µ–º pyproject.toml –≤ —Ç–µ–∫—É—â–µ–π –∏–ª–∏ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    project_root = None
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
    if (current_dir / "pyproject.toml").exists():
        project_root = current_dir
        print(f"‚úÖ –ù–∞–π–¥–µ–Ω Poetry –ø—Ä–æ–µ–∫—Ç –≤ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ: {project_root}")
    
    # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏, –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é
    elif (current_dir.parent / "pyproject.toml").exists():
        project_root = current_dir.parent
        print(f"‚ö†Ô∏è  Pyproject.toml –Ω–∞–π–¥–µ–Ω –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–µ: {project_root}")
        print(f"   –¢–µ–∫—É—â–∞—è –ø–∞–ø–∫–∞: {current_dir.name}")
        choice = input("   –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –ø–∞–ø–∫–∏? (y/n): ")
        if choice.lower() != 'y':
            project_root = current_dir
    
    # –ï—Å–ª–∏ pyproject.toml –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
    if project_root is None:
        project_root = current_dir
        print(f"‚ö†Ô∏è  Pyproject.toml –Ω–µ –Ω–∞–π–¥–µ–Ω, —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é —Ç–µ–∫—É—â—É—é –ø–∞–ø–∫—É: {project_root}")
    
    # –°–æ–∑–¥–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞ —Å –≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–µ—Ç–∫–æ–π
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    output_filename = f"PROJECT_EXPORT_{timestamp}.md"
    
    print(f"üìÇ –≠–∫—Å–ø–æ—Ä—Ç –∏–∑: {project_root}")
    print(f"üìÑ –í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª: {output_filename}")
    print("‚è≥ –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —ç–∫—Å–ø–æ—Ä—Ç...")
    
    try:
        export_project(project_root, output_filename)
        print(f"‚úÖ –≠–∫—Å–ø–æ—Ä—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!")
        print(f"üìä –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω –∫–∞–∫: {output_filename}")
        print("\nüìã –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ:")
        print(f"   1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –≤ VS Code: code {output_filename}")
        print(f"   2. –ò–ª–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –ª—é–±–æ–º Markdown-—Ä–µ–¥–∞–∫—Ç–æ—Ä–µ")
        print(f"   3. –§–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ: {e}")
        print("üîÑ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–π –ø–∞–ø–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞:")
        print(f"   cd {project_root}")
        print("   python export_project_v2.py")
```

### üìÑ main.py
**–†–∞–∑–º–µ—Ä:** 2341 –±–∞–π—Ç  
```python
from kivy.lang import Builder
from kivymd.app import MDApp
from kivy.uix.screenmanager import ScreenManager
from kivy.core.window import Window 
from kivy.metrics import dp

from app.core.config import AppConfig
from app.core.database import DatabaseManager
from app.ui.screens.main_screen import MainScreen

class PlantProtectionApp(MDApp):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.config = AppConfig()
        self.db = DatabaseManager()
        self.screen_manager = None

    def build(self):
        Window.size = (dp(390), dp(640))
        self.theme_cls.primary_palette = "Green"
        self.theme_cls.theme_style = "Light"
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
        self._initialize_components()
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        return self._create_interface()

    def _initialize_components(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
        try:
            # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            self.db.initialize()
            print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞")
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: {e}")

    def _create_interface(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
        self.screen_manager = ScreenManager()
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω
        main_screen = MainScreen(name='main')
        self.screen_manager.add_widget(main_screen)
        
        return self.screen_manager

    # –ú–µ—Ç–æ–¥—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
    def open_diagnosis(self):
        print("üì∑ –û—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π")
    
    def open_catalog(self):
        print("üìö –û—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤")
    
    def open_orders(self):
        print("üõí –û—Ç–∫—Ä—ã—Ç—å –∑–∞–∫–∞–∑—ã –∏ –∫–ª–∏–µ–Ω—Ç—ã")
    
    def open_settings(self):
        print("‚öôÔ∏è –û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏")
    
    def navigation_draw(self):
        print("üìã –û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é –Ω–∞–≤–∏–≥–∞—Ü–∏–∏")

if __name__ == '__main__':
    PlantProtectionApp().run()
```

### üìÑ main_db_test.py
**–†–∞–∑–º–µ—Ä:** 6825 –±–∞–π—Ç  
```python
"""
–¢–ï–°–¢ –ë–ê–ó–´ –î–ê–ù–ù–´–• - –†–ê–ë–û–ß–ê–Ø –í–ï–†–°–ò–Ø
–≠—Ç—É –≤–µ—Ä—Å–∏—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ë–î –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç
"""

from kivy.app import App
from kivy.uix.boxlayout import BoxLayout
from kivy.uix.label import Label
from kivy.uix.button import Button
from pathlib import Path

from app.core.database_backup import DatabaseManagerBackup as DatabaseManager

class DatabaseTestApp(App):
    """
    –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
    –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —ç—Ç–æ—Ç —Ñ–∞–π–ª –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ä–∞–±–æ—á–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    """
    
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.db = DatabaseManager()  # –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ—Å—Ç–æ–≤—É—é –≤–µ—Ä—Å–∏—é
        self.status_label = None
    
    def build(self):
        # –ì–ª–∞–≤–Ω—ã–π layout
        layout = BoxLayout(orientation='vertical', padding=20, spacing=20)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = Label(
            text='Plant Protection App - –¢–µ—Å—Ç –ë–î',
            font_size='24sp',
            size_hint_y=None,
            height=50
        )
        layout.add_widget(title)
        
        # –°—Ç–∞—Ç—É—Å
        self.status_label = Label(
            text='–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î',
            font_size='16sp',
            size_hint_y=None,
            height=100,
            text_size=(400, None)
        )
        layout.add_widget(self.status_label)
        
        # –ö–Ω–æ–ø–∫–∏
        btn_init = Button(
            text='1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ë–î',
            size_hint_y=None,
            height=50,
            on_press=self.initialize_database
        )
        layout.add_widget(btn_init)
        
        btn_check = Button(
            text='2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª –ë–î',
            size_hint_y=None,
            height=50,
            on_press=self.check_database_file
        )
        layout.add_widget(btn_check)
        
        btn_show = Button(
            text='3. –ü–æ–∫–∞–∑–∞—Ç—å –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π',
            size_hint_y=None,
            height=50,
            on_press=self.show_disease_classes
        )
        layout.add_widget(btn_show)
        
        btn_search = Button(
            text='4. –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤',
            size_hint_y=None,
            height=50,
            on_press=self.test_search
        )
        layout.add_widget(btn_search)
        
        btn_tables = Button(
            text='5. –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã',
            size_hint_y=None,
            height=50,
            on_press=self.show_tables_info
        )
        layout.add_widget(btn_tables)
        
        return layout
    
    def show_message(self, message):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å—Ç–∞—Ç—É—Å–µ"""
        if self.status_label:
            self.status_label.text = message
        print("üí¨", message)
    
    def check_database_file(self, instance=None):
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –ë–î"""
        try:
            db_path = Path(__file__).parent / "app" / "assets" / "database" / "plant_protection.db"
            exists = db_path.exists()
            size = db_path.stat().st_size if exists else 0
            
            if exists:
                self.show_message(f"‚úÖ –§–∞–π–ª –ë–î —Å—É—â–µ—Å—Ç–≤—É–µ—Ç\n–†–∞–∑–º–µ—Ä: {size} –±–∞–π—Ç\n–ü—É—Ç—å: {db_path}")
            else:
                self.show_message("‚ùå –§–∞–π–ª –ë–î –Ω–µ –Ω–∞–π–¥–µ–Ω")
        except Exception as e:
            self.show_message(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: {e}")
    
    def initialize_database(self, instance=None):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        try:
            success = self.db.initialize()
            if success:
                self.show_message("‚úÖ –ë–î —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞!")
                self.check_database_file()
            else:
                self.show_message("‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î")
        except Exception as e:
            error_msg = f"‚ùå –û—à–∏–±–∫–∞: {str(e)}"
            self.show_message(error_msg)
    
    def show_disease_classes(self, instance=None):
        """–ü–æ–∫–∞–∑–∞—Ç—å –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π"""
        try:
            classes = self.db.get_all_disease_classes()
            if classes:
                class_names = "\n".join([f"{cls[1]}: {cls[2]}" for cls in classes])
                self.show_message(f"–ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π:\n{class_names}")
            else:
                self.show_message("–ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
        except Exception as e:
            self.show_message(f"–û—à–∏–±–∫–∞: {e}")
    
    def test_search(self, instance=None):
        """–¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤"""
        try:
            results = self.db.search_pesticides("–ê–≥—Ä–æ—Ç–∏–Ω")
            if results:
                pesticide_names = "\n".join([f"{pest[1]} - {pest[5]} —Ä—É–±." for pest in results])
                self.show_message(f"–ù–∞–π–¥–µ–Ω—ã –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã:\n{pesticide_names}")
            else:
                self.show_message("–ü—Ä–µ–ø–∞—Ä–∞—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")
        except Exception as e:
            self.show_message(f"–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞: {e}")
    
    def show_tables_info(self, instance=None):
        """–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö"""
        try:
            cursor = self.db.connection.cursor()
            
            # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
            cursor.execute("SELECT name FROM sqlite_master WHERE type='table'")
            tables = cursor.fetchall()
            
            table_info = []
            for table in tables:
                table_name = table[0]
                cursor.execute(f"SELECT COUNT(*) FROM {table_name}")
                count = cursor.fetchone()[0]
                table_info.append(f"{table_name}: {count} –∑–∞–ø–∏—Å–µ–π")
            
            self.show_message("–¢–∞–±–ª–∏—Ü—ã –≤ –ë–î:\n" + "\n".join(table_info))
            
        except Exception as e:
            self.show_message(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü: {e}")

if __name__ == '__main__':
    print("üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö...")
    print("üíæ –≠—Ç–∞ –≤–µ—Ä—Å–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∫–∞–∫ —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è")
    DatabaseTestApp().run()
```

### üìÑ pyproject.toml
**–†–∞–∑–º–µ—Ä:** 731 –±–∞–π—Ç  
```toml
[tool.poetry]
name = "plant-protection-app"
version = "0.1.0"
description = "My test version of mobile_plant_app"
authors = ["nell.fdorova.00@mail.ru"]
readme = ""  # –£–ë–†–ê–¢–¨ README.md
packages = [{include = "app"}]

# –î–æ–±–∞–≤—å—Ç–µ —ç—Ç—É —Å—Ç—Ä–æ–∫—É —á—Ç–æ–±—ã –æ—Ç–∫–ª—é—á–∏—Ç—å package mode:
package-mode = false

[tool.poetry.dependencies]
python = "^3.11"
kivy = "^2.3.0"
kivymd = "^1.1.1"
pillow = "^10.0.0"
opencv-python = "^4.8.0"
numpy = ">=1.24,<2"
pandas = "^2.0.0"
openpyxl = "^3.1.0"
sqlalchemy = "^2.0.0"

[tool.poetry.group.dev.dependencies]
pytest = "^7.0.0"
black = "^23.0.0"
flake8 = "^6.0.0"

[build-system]
requires = ["poetry-core"]
build-backend = "poetry-core.metadata"
```

### üìÑ app\README.txt
**–†–∞–∑–º–µ—Ä:** 1186 –±–∞–π—Ç  
```text
# –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Ä–∞–±–æ—á–µ–≥–æ –∫–æ–¥–∞

## üìÅ –§–∞–π–ª—ã —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∫–æ–ø–∏–π:

1. **`main_db_test.py`** - —Ç–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ë–î
2. **`app/core/database_backup.py`** - —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è DatabaseManager

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏:

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ë–î:
```bash
python main_db_test.py

## –î–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—á–µ–π –ë–î:
### –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –∏–∑ database_backup.py –≤ database.py
### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ main_db_test.py –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

#–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ù–°
### –∫–ª–∞—Å—Å—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –ù–° —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ \app\assets\disease_classes.txt
disease_classes.txt:
0 –ó–¥–æ—Ä–æ–≤–æ–µ_—Ä–∞—Å—Ç–µ–Ω–∏–µ
1 –ú—É—á–Ω–∏—Å—Ç–∞—è_—Ä–æ—Å–∞  
2 –ü–∞—Ä—à–∞
3 –†–∂–∞–≤—á–∏–Ω–∞
....
–í —ç—Ç–∏ –∫–ª–∞—Å—Å—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î.
–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å main.py
 –∏ –Ω–∞–∂–∞—Ç—å: –û–±–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. 
```

### üìÑ app\__init__.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

### üìÑ app\assets\disease_classes.txt
**–†–∞–∑–º–µ—Ä:** 321 –±–∞–π—Ç  
```text
0 –ó–¥–æ—Ä–æ–≤–æ–µ_—Ä–∞—Å—Ç–µ–Ω–∏–µ
1 –ú—É—á–Ω–∏—Å—Ç–∞—è_—Ä–æ—Å–∞  
2 –ü–∞—Ä—à–∞
3 –†–∂–∞–≤—á–∏–Ω–∞
4 –§–∏—Ç–æ—Ñ—Ç–æ—Ä–æ–∑
5 –ê–Ω—Ç—Ä–∞–∫–Ω–æ–∑
6 –ë–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è_–ø—è—Ç–Ω–∏—Å—Ç–æ—Å—Ç—å
7 –í–∏—Ä—É—Å_–º–æ–∑–∞–∏–∫–∏
8 –°–µ—Ä–∞—è_–≥–Ω–∏–ª—å
9 –ß–µ—Ä–Ω–∞—è_–ø—è—Ç–Ω–∏—Å—Ç–æ—Å—Ç—å
10 –í–µ—Ä—Ç–∏—Ü–∏–ª–ª–µ–∑
```

### üìÑ app\assets\models\plant_disease_model.tflite
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```

```

### üìÑ app\core\__init__.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

### üìÑ app\core\config.py
**–†–∞–∑–º–µ—Ä:** 1118 –±–∞–π—Ç  
```python
import os
from pathlib import Path

class AppConfig:
    """–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
    
    def __init__(self):
        self.app_name = "Plant Protection"
        self.version = "1.0.0"
        
        # –ü—É—Ç–∏ –∫ —Ä–µ—Å—É—Ä—Å–∞–º
        self.base_dir = Path(__file__).parent.parent.parent
        self.assets_dir = self.base_dir / "app" / "assets"
        self.models_dir = self.assets_dir / "models"
        self.database_dir = self.assets_dir / "database"
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        self.database_path = self.database_dir / "plant_protection.db"
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç
        self._create_directories()
    
    def _create_directories(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π"""
        directories = [
            self.assets_dir,
            self.models_dir,
            self.database_dir
        ]
        
        for directory in directories:
            directory.mkdir(parents=True, exist_ok=True)
```

### üìÑ app\core\database.py
**–†–∞–∑–º–µ—Ä:** 14522 –±–∞–π—Ç  
```python
import sqlite3
from pathlib import Path
from app.core.config import AppConfig

class DatabaseManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö SQLite"""
    
    def __init__(self):
        # –ü—Ä—è–º–æ–π –ø—É—Ç—å –∫ –ë–î –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Config
        base_dir = Path(__file__).parent.parent.parent
        self.database_path = base_dir / "app" / "assets" / "database" / "plant_protection.db"
        self.connection = None
        
        # –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        self.database_path.parent.mkdir(parents=True, exist_ok=True)
    
    def initialize(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        try:
            self.connection = sqlite3.connect(self.database_path)
            self.connection.row_factory = sqlite3.Row
            self._create_tables()
            self._insert_sample_data()
            print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ")
            print(f"üìÅ –ü—É—Ç—å –∫ –ë–î: {self.database_path}")
            return True
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î: {e}")
            return False
    
    def _create_tables(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ö–µ–º–µ"""
        cursor = self.connection.cursor()
        
        # 1. –¢–∞–±–ª–∏—Ü–∞ —Ç–∏–ø–æ–≤ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_types (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                type_name TEXT NOT NULL UNIQUE
            )
        ''')
        
        # 2. –¢–∞–±–ª–∏—Ü–∞ –∫—É–ª—å—Ç—É—Ä
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS cultures (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                culture_name TEXT NOT NULL UNIQUE
            )
        ''')
        
        # 3. –¢–∞–±–ª–∏—Ü–∞ –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –≤–µ—â–µ—Å—Ç–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS active_substances (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                substance_name TEXT NOT NULL UNIQUE
            )
        ''')
        

        # 4. –¢–∞–±–ª–∏—Ü–∞ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è)
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS disease_classes (
                class_index INTEGER PRIMARY KEY,  -- –ò–Ω–¥–µ–∫—Å –∏–∑ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –∫–∞–∫ PRIMARY KEY
                class_name TEXT NOT NULL UNIQUE   -- –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è
            )
        ''')

        # 5. –¢–∞–±–ª–∏—Ü–∞ –±–æ–ª–µ–∑–Ω–µ–π —Ä–∞—Å—Ç–µ–Ω–∏–π
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS diseases (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                disease_name TEXT NOT NULL UNIQUE,
                symptoms TEXT,
                prevention_methods TEXT,
                culture_id INTEGER REFERENCES cultures(id),
                disease_class_index INTEGER REFERENCES disease_classes(class_index)  -- –ü—Ä–∏–≤—è–∑–∫–∞ –∫ class_index
            )
        ''')
        
        # 6. –¢–∞–±–ª–∏—Ü–∞ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticides (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                name TEXT NOT NULL,
                description TEXT,
                application_rate TEXT,
                packaging TEXT,
                price DECIMAL(10, 2),
                manufacturer TEXT,
                unit_of_measure TEXT,
                # image_url TEXT,
                pesticide_type_id INTEGER REFERENCES pesticide_types(id)
            )
        ''')
        
        # 7. –°–≤—è–∑—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã
        
        # –ü–µ—Å—Ç–∏—Ü–∏–¥—ã - –î–µ–π—Å—Ç–≤—É—é—â–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_active_substances (
                pesticide_id INTEGER REFERENCES pesticides(id),
                substance_id INTEGER REFERENCES active_substances(id),
                concentration TEXT,
                PRIMARY KEY (pesticide_id, substance_id)
            )
        ''')
        
        # –ü–µ—Å—Ç–∏—Ü–∏–¥—ã - –ö—É–ª—å—Ç—É—Ä—ã
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_cultures (
                pesticide_id INTEGER REFERENCES pesticides(id),
                culture_id INTEGER REFERENCES cultures(id),
                PRIMARY KEY (pesticide_id, culture_id)
            )
        ''')
        
        # –ü–µ—Å—Ç–∏—Ü–∏–¥—ã - –ë–æ–ª–µ–∑–Ω–∏
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_diseases (
                pesticide_id INTEGER REFERENCES pesticides(id),
                disease_id INTEGER REFERENCES diseases(id),
                PRIMARY KEY (pesticide_id, disease_id)
            )
        ''')
        
        # 8. –¢–∞–±–ª–∏—Ü–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS clients (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                client_name TEXT NOT NULL,
                contact_person TEXT,
                phone TEXT,
                email TEXT,
                total_orchard_area DECIMAL(10, 2),
                address TEXT,
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        # 9. –¢–∞–±–ª–∏—Ü–∞ –∫—É–ª—å—Ç—É—Ä –∫–ª–∏–µ–Ω—Ç–∞
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS client_cultures (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                client_id INTEGER REFERENCES clients(id),
                culture_id INTEGER REFERENCES cultures(id),
                area DECIMAL(10, 2),
                UNIQUE(client_id, culture_id)
            )
        ''')
        
        # 10. –¢–∞–±–ª–∏—Ü–∞ –∑–∞–∫–∞–∑–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS orders (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                order_number TEXT UNIQUE,
                client_id INTEGER REFERENCES clients(id),
                order_date DATE NOT NULL,
                shipment_date DATE,
                payment_date DATE,
                total_amount DECIMAL(12, 2),
                status TEXT DEFAULT '—á–µ—Ä–Ω–æ–≤–∏–∫',
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        # 11. –¢–∞–±–ª–∏—Ü–∞ –ø–æ–∑–∏—Ü–∏–π –∑–∞–∫–∞–∑–∞
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS order_items (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                order_id INTEGER REFERENCES orders(id),
                pesticide_id INTEGER REFERENCES pesticides(id),
                culture_id INTEGER REFERENCES cultures(id),
                quantity DECIMAL(10, 3),
                packaging TEXT,
                unit_price DECIMAL(10, 2),
                discount DECIMAL(5, 2) DEFAULT 0,
                discounted_price DECIMAL(10, 2),
                item_total DECIMAL(12, 2),
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        self.connection.commit()
        print("‚úÖ –¢–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω—ã")
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ —Ñ–∞–π–ª–∞
        self._load_disease_classes_from_file()
    
    def _insert_sample_data(self):
     """–í—Å—Ç–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö - –û–°–ù–û–í–ù–ê–Ø –í–ï–†–°–ò–Ø (–ø—É—Å—Ç–∞—è)"""
    # –í –æ—Å–Ω–æ–≤–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –Ω–µ –∑–∞–ø–æ–ª–Ω—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    # –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É –∏–ª–∏ –∏–º–ø–æ—Ä—Ç
    pass

    # –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
    
    def get_disease_class_by_index(self, class_index):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –ø–æ –∏–Ω–¥–µ–∫—Å—É –Ω–µ–π—Ä–æ—Å–µ—Ç–∏"""
        cursor = self.connection.cursor()
        cursor.execute('''
            SELECT * FROM disease_classes 
            WHERE class_index = ?
        ''', (class_index,))
        return cursor.fetchone()

    def get_all_disease_classes(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π"""
        cursor = self.connection.cursor()
        cursor.execute('''
            SELECT * FROM disease_classes 
            ORDER BY class_index
        ''')
        return cursor.fetchall()

    def update_disease_classes_from_file(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ —Ñ–∞–π–ª–∞"""
        print("üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π...")
        self._load_disease_classes_from_file()
        return True
   
    
    def get_recommendations_for_disease_class(self, class_index):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –∫–ª–∞—Å—Å–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è"""
        cursor = self.connection.cursor()
        cursor.execute('''
            SELECT p.* FROM pesticides p
            JOIN pesticide_diseases pd ON p.id = pd.pesticide_id
            JOIN diseases d ON pd.disease_id = d.id
            WHERE d.disease_class_id = ?
            LIMIT 10
        ''', (class_index,))
        return cursor.fetchall()
    
def search_pesticides(self, query, filters=None):
    """–ü–æ–∏—Å–∫ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏"""
    cursor = self.connection.cursor()
    
    sql = '''
        SELECT DISTINCT p.*
        FROM pesticides p
        LEFT JOIN pesticide_active_substances pas ON p.id = pas.pesticide_id
        LEFT JOIN active_substances as ON pas.substance_id = as.id
        LEFT JOIN pesticide_diseases pd ON p.id = pd.pesticide_id
        LEFT JOIN diseases d ON pd.disease_id = d.id
        WHERE (p.name LIKE ? OR as.substance_name LIKE ? OR d.disease_name LIKE ?)
    '''
    params = [f'%{query}%', f'%{query}%', f'%{query}%']
    
    cursor.execute(sql, params)
    return cursor.fetchall()
    
    def close(self):
        """–ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î"""
        if self.connection:
            self.connection.close()
def _load_disease_classes_from_file(self):
    """–ó–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ TXT —Ñ–∞–π–ª–∞"""
    try:
        # –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –∫–ª–∞—Å—Å–∞–º–∏
        classes_file = self.database_path.parent / "disease_classes.txt"
        
        if not classes_file.exists():
            print("‚ö†Ô∏è –§–∞–π–ª disease_classes.txt –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–ª–∞—Å—Å—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é")
            self._create_default_disease_classes()
            return
        
        cursor = self.connection.cursor()
        
        # –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        cursor.execute('DELETE FROM disease_classes')
        
        # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª
        with open(classes_file, 'r', encoding='utf-8') as f:
            for line in f:
                line = line.strip()
                if line and not line.startswith('#'):  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
                    parts = line.split(' ', 1)  # –†–∞–∑–¥–µ–ª—è–µ–º –ø–æ –ø–µ—Ä–≤–æ–º—É –ø—Ä–æ–±–µ–ª—É
                    if len(parts) == 2:
                        class_index = int(parts[0])
                        class_name = parts[1].replace('_', ' ')  # –ó–∞–º–µ–Ω—è–µ–º –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–±–µ–ª—ã
                        
                        cursor.execute('''
                            INSERT INTO disease_classes (class_index, class_name)
                            VALUES (?, ?)
                        ''', (class_index, class_name))
        
        self.connection.commit()
        print(f"‚úÖ –ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞: {classes_file.name}")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π: {e}")
        self._create_default_disease_classes()

def _create_default_disease_classes(self):
    """–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"""
    try:
        cursor = self.connection.cursor()
        
        default_classes = [
            (0, '–ó–¥–æ—Ä–æ–≤–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ'),
            (1, '–ú—É—á–Ω–∏—Å—Ç–∞—è —Ä–æ—Å–∞'),
            (2, '–ü–∞—Ä—à–∞'),
            (3, '–†–∂–∞–≤—á–∏–Ω–∞'),
            (4, '–§–∏—Ç–æ—Ñ—Ç–æ—Ä–æ–∑'),
            (5, '–ê–Ω—Ç—Ä–∞–∫–Ω–æ–∑'),
            (6, '–ë–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –ø—è—Ç–Ω–∏—Å—Ç–æ—Å—Ç—å'),
            (7, '–í–∏—Ä—É—Å –º–æ–∑–∞–∏–∫–∏')
        ]
        
        cursor.executemany('''
            INSERT OR REPLACE INTO disease_classes (class_index, class_name)
            VALUES (?, ?)
        ''', default_classes)
        
        self.connection.commit()
        print("‚úÖ –°–æ–∑–¥–∞–Ω—ã –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: {e}")


def export_disease_classes_to_file(self):
    """–≠–∫—Å–ø–æ—Ä—Ç –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –≤ TXT —Ñ–∞–π–ª"""
    try:
        classes_file = self.database_path.parent / "disease_classes_export.txt"
        
        cursor = self.connection.cursor()
        cursor.execute('SELECT class_index, class_name FROM disease_classes ORDER BY class_index')
        classes = cursor.fetchall()
        
        with open(classes_file, 'w', encoding='utf-8') as f:
            for class_item in classes:
                # –ó–∞–º–µ–Ω—è–µ–º –ø—Ä–æ–±–µ–ª—ã –Ω–∞ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
                class_name = class_item[1].replace(' ', '_')
                f.write(f"{class_item[0]} {class_name}\n")
        
        print(f"‚úÖ –ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤: {classes_file.name}")
        return str(classes_file)
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –∫–ª–∞—Å—Å–æ–≤: {e}")
        return None
```

### üìÑ app\core\database_backup.py
**–†–∞–∑–º–µ—Ä:** 18010 –±–∞–π—Ç  
```python
"""
–ë–ê–ó–ê –î–ê–ù–ù–´–• - –¢–ï–°–¢–û–í–ê–Ø –í–ï–†–°–ò–Ø –° –î–ê–ù–ù–´–ú–ò
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å main_db_test.py
"""

import sqlite3
from pathlib import Path
from app.core.test_data import get_test_data

class DatabaseManagerBackup:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö SQLite - –¢–ï–°–¢–û–í–ê–Ø –í–ï–†–°–ò–Ø –° –î–ê–ù–ù–´–ú–ò"""
    
    def __init__(self):
        # –ü—Ä—è–º–æ–π –ø—É—Ç—å –∫ –ë–î
        base_dir = Path(__file__).parent.parent.parent
        self.database_path = base_dir / "app" / "assets" / "database" / "plant_protection.db"
        self.connection = None
        
        # –°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        self.database_path.parent.mkdir(parents=True, exist_ok=True)
    
    def initialize(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"""
        try:
            self.connection = sqlite3.connect(self.database_path)
            self.connection.row_factory = sqlite3.Row
            self._create_tables()
            self._insert_test_data()  # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
            print("‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏")
            return True
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î: {e}")
            return False
    
    def _create_tables(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"""
        cursor = self.connection.cursor()
        
        # –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã (–∫–æ–ø–∏—è –∏–∑ database.py)
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_types (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                type_name TEXT NOT NULL UNIQUE
            )
        ''')
        
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS cultures (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                culture_name TEXT NOT NULL UNIQUE
            )
        ''')
        
        # 3. –¢–∞–±–ª–∏—Ü–∞ –¥–µ–π—Å—Ç–≤—É—é—â–∏—Ö –≤–µ—â–µ—Å—Ç–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS active_substances (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                substance_name TEXT NOT NULL UNIQUE
            )
        ''')
        
 # 4. –¢–∞–±–ª–∏—Ü–∞ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è)
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS disease_classes (
                class_index INTEGER PRIMARY KEY,
                class_name TEXT NOT NULL UNIQUE
        )
    ''')
    
    # 5. –¢–∞–±–ª–∏—Ü–∞ –±–æ–ª–µ–∑–Ω–µ–π —Ä–∞—Å—Ç–µ–Ω–∏–π
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS diseases (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            disease_name TEXT NOT NULL UNIQUE,
            symptoms TEXT,
            prevention_methods TEXT,
            culture_id INTEGER REFERENCES cultures(id),
            disease_class_index INTEGER REFERENCES disease_classes(class_index)
        )
    ''')
        
        # 6. –¢–∞–±–ª–∏—Ü–∞ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticides (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                name TEXT NOT NULL,
                description TEXT,
                application_rate TEXT,
                packaging TEXT,
                price DECIMAL(10, 2),
                manufacturer TEXT,
                unit_of_measure TEXT,
                image_url TEXT,
                pesticide_type_id INTEGER REFERENCES pesticide_types(id)
            )
        ''')
        
        # 7. –°–≤—è–∑—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã
        
        # –ü–µ—Å—Ç–∏—Ü–∏–¥—ã - –î–µ–π—Å—Ç–≤—É—é—â–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_active_substances (
                pesticide_id INTEGER REFERENCES pesticides(id),
                substance_id INTEGER REFERENCES active_substances(id),
                concentration TEXT,
                PRIMARY KEY (pesticide_id, substance_id)
            )
        ''')
        
        # –ü–µ—Å—Ç–∏—Ü–∏–¥—ã - –ö—É–ª—å—Ç—É—Ä—ã
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_cultures (
                pesticide_id INTEGER REFERENCES pesticides(id),
                culture_id INTEGER REFERENCES cultures(id),
                PRIMARY KEY (pesticide_id, culture_id)
            )
        ''')
        
        # –ü–µ—Å—Ç–∏—Ü–∏–¥—ã - –ë–æ–ª–µ–∑–Ω–∏
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS pesticide_diseases (
                pesticide_id INTEGER REFERENCES pesticides(id),
                disease_id INTEGER REFERENCES diseases(id),
                PRIMARY KEY (pesticide_id, disease_id)
            )
        ''')
        
        # 8. –¢–∞–±–ª–∏—Ü–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS clients (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                client_name TEXT NOT NULL,
                contact_person TEXT,
                phone TEXT,
                email TEXT,
                total_orchard_area DECIMAL(10, 2),
                address TEXT,
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        # 9. –¢–∞–±–ª–∏—Ü–∞ –∫—É–ª—å—Ç—É—Ä –∫–ª–∏–µ–Ω—Ç–∞
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS client_cultures (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                client_id INTEGER REFERENCES clients(id),
                culture_id INTEGER REFERENCES cultures(id),
                area DECIMAL(10, 2),
                UNIQUE(client_id, culture_id)
            )
        ''')
        
        # 10. –¢–∞–±–ª–∏—Ü–∞ –∑–∞–∫–∞–∑–æ–≤
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS orders (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                order_number TEXT UNIQUE,
                client_id INTEGER REFERENCES clients(id),
                order_date DATE NOT NULL,
                shipment_date DATE,
                payment_date DATE,
                total_amount DECIMAL(12, 2),
                status TEXT DEFAULT '—á–µ—Ä–Ω–æ–≤–∏–∫',
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        # 11. –¢–∞–±–ª–∏—Ü–∞ –ø–æ–∑–∏—Ü–∏–π –∑–∞–∫–∞–∑–∞
        cursor.execute('''
            CREATE TABLE IF NOT EXISTS order_items (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                order_id INTEGER REFERENCES orders(id),
                pesticide_id INTEGER REFERENCES pesticides(id),
                culture_id INTEGER REFERENCES cultures(id),
                quantity DECIMAL(10, 3),
                packaging TEXT,
                unit_price DECIMAL(10, 2),
                discount DECIMAL(5, 2) DEFAULT 0,
                discounted_price DECIMAL(10, 2),
                item_total DECIMAL(12, 2),
                created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
            )
        ''')
        
        self.connection.commit()
        print("‚úÖ –¢–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω—ã")
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ —Ñ–∞–π–ª–∞
        self._load_disease_classes_from_file()
    
    def _insert_test_data(self):
        """–í—Å—Ç–∞–≤–∫–∞ –¢–ï–°–¢–û–í–´–• –¥–∞–Ω–Ω—ã—Ö –∏–∑ test_data.py"""
        cursor = self.connection.cursor()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –¥–∞–Ω–Ω—ã–µ
        cursor.execute("SELECT COUNT(*) FROM pesticides")
        if cursor.fetchone()[0] == 0:
            print("üìù –î–æ–±–∞–≤–ª—è–µ–º –¢–ï–°–¢–û–í–´–ï –¥–∞–Ω–Ω—ã–µ...")
            
            test_data = get_test_data()
            
            # 1. –ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π
            cursor.executemany('''
                INSERT INTO disease_classes (class_index, class_name, description, is_active)
                VALUES (?, ?, ?, ?)
            ''', test_data['disease_classes'])
            
            # 2. –ö—É–ª—å—Ç—É—Ä—ã
            for culture in test_data['cultures']:
                cursor.execute('INSERT INTO cultures (culture_name) VALUES (?)', (culture,))
            
            # 3. –¢–∏–ø—ã –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤
            for p_type in test_data['pesticide_types']:
                cursor.execute('INSERT INTO pesticide_types (type_name) VALUES (?)', (p_type,))
            
            # 4. –î–µ–π—Å—Ç–≤—É—é—â–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞
            for substance in test_data['substances']:
                cursor.execute('INSERT INTO active_substances (substance_name) VALUES (?)', (substance,))
            
            # 5. –ë–æ–ª–µ–∑–Ω–∏
            cursor.executemany('''
                INSERT INTO diseases (disease_name, symptoms, culture_id, disease_class_id) 
                VALUES (?, ?, ?, ?)
            ''', test_data['diseases'])
            
            # 6. –ü–µ—Å—Ç–∏—Ü–∏–¥—ã
            cursor.executemany('''
                INSERT INTO pesticides (name, description, application_rate, packaging, price, manufacturer, unit_of_measure, pesticide_type_id)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?)
            ''', test_data['pesticides'])
            
            # 7. –°–≤—è–∑–∏ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤ —Å –≤–µ—â–µ—Å—Ç–≤–∞–º–∏
            cursor.executemany('''
                INSERT INTO pesticide_active_substances (pesticide_id, substance_id, concentration)
                VALUES (?, ?, ?)
            ''', test_data['pesticide_substances'])
            
            # 8. –°–≤—è–∑–∏ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤ —Å –∫—É–ª—å—Ç—É—Ä–∞–º–∏
            cursor.executemany('''
                INSERT INTO pesticide_cultures (pesticide_id, culture_id)
                VALUES (?, ?)
            ''', test_data['pesticide_cultures'])
            
            # 9. –°–≤—è–∑–∏ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤ —Å –±–æ–ª–µ–∑–Ω—è–º–∏
            cursor.executemany('''
                INSERT INTO pesticide_diseases (pesticide_id, disease_id)
                VALUES (?, ?)
            ''', test_data['pesticide_diseases'])
            
            # 10. –ö–ª–∏–µ–Ω—Ç—ã
            cursor.executemany('''
                INSERT INTO clients (client_name, contact_person, phone, email, total_orchard_area, address)
                VALUES (?, ?, ?, ?, ?, ?)
            ''', test_data['clients'])
            
            self.connection.commit()
            print("‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã")

    # –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏
    
    def get_disease_class_by_index(self, class_index):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –ø–æ –∏–Ω–¥–µ–∫—Å—É –Ω–µ–π—Ä–æ—Å–µ—Ç–∏"""
        cursor = self.connection.cursor()
        cursor.execute('''
            SELECT * FROM disease_classes 
            WHERE class_index = ?
        ''', (class_index,))
        return cursor.fetchone()

    def get_all_disease_classes(self):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π"""
        cursor = self.connection.cursor()
        cursor.execute('''
            SELECT * FROM disease_classes 
            ORDER BY class_index
        ''')
        return cursor.fetchall()

    def update_disease_classes_from_file(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ —Ñ–∞–π–ª–∞"""
        print("üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π...")
        self._load_disease_classes_from_file()
        return True
    
    def get_recommendations_for_disease_class(self, class_index):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –¥–ª—è –∫–ª–∞—Å—Å–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è"""
        cursor = self.connection.cursor()
        cursor.execute('''
            SELECT p.* FROM pesticides p
            JOIN pesticide_diseases pd ON p.id = pd.pesticide_id
            JOIN diseases d ON pd.disease_id = d.id
            WHERE d.disease_class_id = ?
            LIMIT 10
        ''', (class_index,))
        return cursor.fetchall()
    
    
    def search_pesticides(self, query, filters=None):
        """–ü–æ–∏—Å–∫ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ - –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏"""
        try:
            cursor = self.connection.cursor()
            
            sql = '''
                SELECT p.*, pt.type_name 
                FROM pesticides p
                LEFT JOIN pesticide_types pt ON p.pesticide_type_id = pt.id
                WHERE p.name LIKE ? OR p.description LIKE ?
            '''
            params = [f'%{query}%', f'%{query}%']
            
            cursor.execute(sql, params)
            return cursor.fetchall()
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞: {e}")
            return []
    
    def get_all_pesticides(self):
        """–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã - –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏"""
        try:
            cursor = self.connection.cursor()
            cursor.execute('''
                SELECT p.*, pt.type_name 
                FROM pesticides p
                LEFT JOIN pesticide_types pt ON p.pesticide_type_id = pt.id
                ORDER BY p.name
            ''')
            return cursor.fetchall()
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤: {e}")
            return []
    
    def close(self):
        """–ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å –ë–î"""
        if self.connection:
            self.connection.close()


def export_disease_classes_to_file(self):
    """–≠–∫—Å–ø–æ—Ä—Ç –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –≤ TXT —Ñ–∞–π–ª"""
    try:
        classes_file = self.database_path.parent / "disease_classes_export.txt"
        
        cursor = self.connection.cursor()
        cursor.execute('SELECT class_index, class_name FROM disease_classes ORDER BY class_index')
        classes = cursor.fetchall()
        
        with open(classes_file, 'w', encoding='utf-8') as f:
            for class_item in classes:
                # –ó–∞–º–µ–Ω—è–µ–º –ø—Ä–æ–±–µ–ª—ã –Ω–∞ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
                class_name = class_item[1].replace(' ', '_')
                f.write(f"{class_item[0]} {class_name}\n")
        
        print(f"‚úÖ –ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤: {classes_file.name}")
        return str(classes_file)
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –∫–ª–∞—Å—Å–æ–≤: {e}")
        return None

def _load_disease_classes_from_file(self):
    """–ó–∞–≥—Ä—É–∑–∫–∞ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ TXT —Ñ–∞–π–ª–∞"""
    try:
        # –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å –∫–ª–∞—Å—Å–∞–º–∏
        classes_file = self.database_path.parent / "disease_classes.txt"
        
        if not classes_file.exists():
            print("‚ö†Ô∏è –§–∞–π–ª disease_classes.txt –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–ª–∞—Å—Å—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é")
            self._create_default_disease_classes()
            return
        
        cursor = self.connection.cursor()
        
        # –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        cursor.execute('DELETE FROM disease_classes')
        
        # –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª
        with open(classes_file, 'r', encoding='utf-8') as f:
            for line in f:
                line = line.strip()
                if line and not line.startswith('#'):  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
                    parts = line.split(' ', 1)  # –†–∞–∑–¥–µ–ª—è–µ–º –ø–æ –ø–µ—Ä–≤–æ–º—É –ø—Ä–æ–±–µ–ª—É
                    if len(parts) == 2:
                        class_index = int(parts[0])
                        class_name = parts[1].replace('_', ' ')  # –ó–∞–º–µ–Ω—è–µ–º –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏—è –Ω–∞ –ø—Ä–æ–±–µ–ª—ã
                        
                        cursor.execute('''
                            INSERT INTO disease_classes (class_index, class_name)
                            VALUES (?, ?)
                        ''', (class_index, class_name))
        
        self.connection.commit()
        print(f"‚úÖ –ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞: {classes_file.name}")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π: {e}")
        self._create_default_disease_classes()

def _create_default_disease_classes(self):
    """–°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"""
    try:
        cursor = self.connection.cursor()
        
        default_classes = [
            (0, '–ó–¥–æ—Ä–æ–≤–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ'),
            (1, '–ú—É—á–Ω–∏—Å—Ç–∞—è —Ä–æ—Å–∞'),
            (2, '–ü–∞—Ä—à–∞'),
            (3, '–†–∂–∞–≤—á–∏–Ω–∞'),
            (4, '–§–∏—Ç–æ—Ñ—Ç–æ—Ä–æ–∑'),
            (5, '–ê–Ω—Ç—Ä–∞–∫–Ω–æ–∑'),
            (6, '–ë–∞–∫—Ç–µ—Ä–∏–∞–ª—å–Ω–∞—è –ø—è—Ç–Ω–∏—Å—Ç–æ—Å—Ç—å'),
            (7, '–í–∏—Ä—É—Å –º–æ–∑–∞–∏–∫–∏')
        ]
        
        cursor.executemany('''
            INSERT OR REPLACE INTO disease_classes (class_index, class_name)
            VALUES (?, ?)
        ''', default_classes)
        
        self.connection.commit()
        print("‚úÖ –°–æ–∑–¥–∞–Ω—ã –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: {e}")
```

### üìÑ app\core\test_data.py
**–†–∞–∑–º–µ—Ä:** 3919 –±–∞–π—Ç  
```python
"""
–¢–ï–°–¢–û–í–´–ï –î–ê–ù–ù–´–ï –î–õ–Ø –ë–ê–ó–´ –î–ê–ù–ù–´–•
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ (main_db_test.py)
"""

def get_test_data():
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å–µ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ë–î"""
    
    return {
        # 1. –ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏
        'disease_classes': [
            (0, '–ó–¥–æ—Ä–æ–≤–æ–µ —Ä–∞—Å—Ç–µ–Ω–∏–µ', '–†–∞—Å—Ç–µ–Ω–∏–µ –±–µ–∑ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π', 1),
            (1, '–ú—É—á–Ω–∏—Å—Ç–∞—è —Ä–æ—Å–∞', '–ì—Ä–∏–±–∫–æ–≤–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ —Å –±–µ–ª—ã–º –Ω–∞–ª–µ—Ç–æ–º', 1),
            (2, '–ü–∞—Ä—à–∞', '–ü—è—Ç–Ω–∏—Å—Ç–æ—Å—Ç—å –ª–∏—Å—Ç—å–µ–≤ –∏ –ø–ª–æ–¥–æ–≤', 1),
            (3, '–†–∂–∞–≤—á–∏–Ω–∞', '–†–∂–∞–≤—ã–µ –ø—è—Ç–Ω–∞ –Ω–∞ –ª–∏—Å—Ç—å—è—Ö', 1)
        ],
        
        # 2. –ö—É–ª—å—Ç—É—Ä—ã
        'cultures': ['–ü—à–µ–Ω–∏—Ü–∞', '–Ø–±–ª–æ–Ω—è', '–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å', '–¢–æ–º–∞—Ç—ã'],
        
        # 3. –¢–∏–ø—ã –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤
        'pesticide_types': ['–ì–µ—Ä–±–∏—Ü–∏–¥—ã', '–ò–Ω—Å–µ–∫—Ç–∏—Ü–∏–¥—ã', '–§—É–Ω–≥–∏—Ü–∏–¥—ã'],
        
        # 4. –î–µ–π—Å—Ç–≤—É—é—â–∏–µ –≤–µ—â–µ—Å—Ç–≤–∞
        'substances': ['–ú–µ—Ç—Å—É–ª—å—Ñ—É—Ä–æ–Ω-–º–µ—Ç–∏–ª', '–ò–º–∏–¥–∞–∫–ª–æ–ø—Ä–∏–¥', '–î–∏—Ñ–µ–Ω–æ–∫–æ–Ω–∞–∑–æ–ª'],
        
        # 5. –ë–æ–ª–µ–∑–Ω–∏
        'diseases': [
            ('–ú—É—á–Ω–∏—Å—Ç–∞—è —Ä–æ—Å–∞ —è–±–ª–æ–Ω–∏', '–ë–µ–ª—ã–π –º—É—á–Ω–∏—Å—Ç—ã–π –Ω–∞–ª–µ—Ç –Ω–∞ –ª–∏—Å—Ç—å—è—Ö', 2, 1),
            ('–ü–∞—Ä—à–∞ —è–±–ª–æ–Ω–∏', '–û–ª–∏–≤–∫–æ–≤–æ-–±—É—Ä—ã–µ –ø—è—Ç–Ω–∞ –Ω–∞ –ª–∏—Å—Ç—å—è—Ö', 2, 2),
            ('–§–∏—Ç–æ—Ñ—Ç–æ—Ä–æ–∑ –∫–∞—Ä—Ç–æ—Ñ–µ–ª—è', '–ë—É—Ä—ã–µ –ø—è—Ç–Ω–∞ –Ω–∞ –ª–∏—Å—Ç—å—è—Ö –∏ –∫–ª—É–±–Ω—è—Ö', 3, 3)
        ],
        
        # 6. –ü–µ—Å—Ç–∏—Ü–∏–¥—ã
        'pesticides': [
            ('–ì–µ—Ä–±–∏—Ü–∏–¥ 1', '–°–∏—Å—Ç–µ–º–Ω—ã–π –≥–µ—Ä–±–∏—Ü–∏–¥ —à–∏—Ä–æ–∫–æ–≥–æ —Å–ø–µ–∫—Ç—Ä–∞', '0,1-0,2 –ª/–≥–∞', '–ö–∞–Ω–∏—Å—Ç—Ä–∞ 5–ª', 2500.00, '–ê–≥—Ä–æ—Ö–∏–º', '–ª', 1),
            ('–§—É–Ω–≥–∏—Ü–∏–¥ 1', '–°–∏—Å—Ç–µ–º–Ω—ã–π —Ñ—É–Ω–≥–∏—Ü–∏–¥ –æ—Ç –º—É—á–Ω–∏—Å—Ç–æ–π —Ä–æ—Å—ã', '0,5 –∫–≥/–≥–∞', '–ü–∞–∫–µ—Ç 1–∫–≥', 1800.00, '–ë–∞–π–µ—Ä', '–∫–≥', 3),
            ('–ò–Ω—Å–µ–∫—Ç–∏—Ü–∏–¥ 1', '–ö–∏—à–µ—á–Ω–æ-–∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π –∏–Ω—Å–µ–∫—Ç–∏—Ü–∏–¥', '0,2 –ª/–≥–∞', '–§–ª–∞–∫–æ–Ω 1–ª', 3200.00, '–°–∏–Ω–≥–µ–Ω—Ç–∞', '–ª', 2),
            ('–ê–≥—Ä–æ—Ç–∏–Ω –í–î–ì', '–ú–æ—â–Ω—ã–π –≥–µ—Ä–±–∏—Ü–∏–¥ –¥–ª—è –∑–ª–∞–∫–æ–≤—ã—Ö', '0,07-0,1 –∫–≥/–≥–∞', '–ü–∞–∫–µ—Ç 0,1–∫–≥', 1500.00, '–ê–≥—Ä–æ—Ö–∏–º', '–∫–≥', 1),
            ('–ó–∞—â–∏—Ç–∞ –ü–ª—é—Å', '–§—É–Ω–≥–∏—Ü–∏–¥ –¥–ª—è –ø–ª–æ–¥–æ–≤—ã—Ö –∫—É–ª—å—Ç—É—Ä', '0,8 –ª/–≥–∞', '–ö–∞–Ω–∏—Å—Ç—Ä–∞ 10–ª', 4200.00, '–ë–∞–π–µ—Ä', '–ª', 3)
        ],
        
        # 7. –°–≤—è–∑–∏ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤ —Å –≤–µ—â–µ—Å—Ç–≤–∞–º–∏
        'pesticide_substances': [
            (1, 1, '500 –≥/–∫–≥'),
            (2, 3, '250 –≥/–ª'),
            (3, 2, '200 –≥/–ª'),
            (4, 1, '600 –≥/–∫–≥'),
            (5, 3, '300 –≥/–ª')
        ],
        
        # 8. –°–≤—è–∑–∏ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤ —Å –∫—É–ª—å—Ç—É—Ä–∞–º–∏
        'pesticide_cultures': [
            (1, 1), (1, 2),
            (2, 2), (2, 4),
            (3, 2), (3, 3),
            (4, 1),
            (5, 2), (5, 4)
        ],
        
        # 9. –°–≤—è–∑–∏ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤ —Å –±–æ–ª–µ–∑–Ω—è–º–∏
        'pesticide_diseases': [
            (2, 1),
            (2, 2),
            (5, 1),
            (5, 3)
        ],
        
        # 10. –ö–ª–∏–µ–Ω—Ç—ã
        'clients': [
            ('–û–û–û "–ê–≥—Ä–æ—Ñ–∏—Ä–º–∞ –í–µ—Å–Ω–∞"', '–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω', '+79991234567', 'agro@mail.ru', 150.5, '–ú–æ—Å–∫–æ–≤—Å–∫–∞—è –æ–±–ª., –≥. –î–æ–º–æ–¥–µ–¥–æ–≤–æ'),
            ('–ö–§–• "–ü–æ–ª–µ—Å—å–µ"', '–ü–µ—Ç—Ä–æ–≤ –ü–µ—Ç—Ä', '+79997654321', 'pole@mail.ru', 85.2, '–ö–∞–ª—É–∂—Å–∫–∞—è –æ–±–ª., –¥. –ü–æ–ª–µ–≤–∞—è')
        ]
    }
```

### üìÑ app\ml\__init__.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

### üìÑ app\ml\image_processor.py
**–†–∞–∑–º–µ—Ä:** 2091 –±–∞–π—Ç  
```python
import cv2
import numpy as np
from PIL import Image

class ImageProcessor:
    """–ö–ª–∞—Å—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –ø–æ–¥–∞—á–µ–π –≤ –Ω–µ–π—Ä–æ—Å–µ—Ç—å"""
    
    @staticmethod
    def preprocess_image(image_path, target_size=(224, 224)):
        """–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏"""
        try:
            # –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            image = Image.open(image_path)
            image = image.convert('RGB')
            
            # –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞
            image = image.resize(target_size)
            
            # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ numpy array –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
            image_array = np.array(image) / 255.0
            
            # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ batch dimension
            image_array = np.expand_dims(image_array, axis=0)
            
            return image_array
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: {e}")
            return None
    
    @staticmethod
    def load_and_preprocess_from_bytes(image_bytes, target_size=(224, 224)):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ bytes"""
        try:
            # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è bytes –≤ numpy array
            nparr = np.frombuffer(image_bytes, np.uint8)
            image = cv2.imdecode(nparr, cv2.IMREAD_COLOR)
            image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)
            
            # –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞
            image = cv2.resize(image, target_size)
            
            # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
            image = image / 255.0
            
            # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ batch dimension
            image = np.expand_dims(image, axis=0)
            
            return image
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–∑ bytes: {e}")
            return None
```

### üìÑ app\ml\model_loader.py
**–†–∞–∑–º–µ—Ä:** 2537 –±–∞–π—Ç  
```python
import tensorflow as tf
import numpy as np

class ModelLoader:
    """–ö–ª–∞—Å—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π TensorFlow Lite"""
    
    def __init__(self):
        self.model = None
        self.input_details = None
        self.output_details = None
    
    def load_model(self, model_path):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ TFLite"""
        try:
            # –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏
            self.model = tf.lite.Interpreter(model_path=model_path)
            self.model.allocate_tensors()
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—Ö–æ–¥–µ –∏ –≤—ã—Ö–æ–¥–µ
            self.input_details = self.model.get_input_details()
            self.output_details = self.model.get_output_details()
            
            print("‚úÖ –ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞")
            return True
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏: {e}")
            return False
    
    def predict(self, input_data):
        """–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
        try:
            if self.model is None:
                raise ValueError("–ú–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞")
            
            # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            self.model.set_tensor(self.input_details[0]['index'], input_data.astype(np.float32))
            
            # –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
            self.model.invoke()
            
            # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            output_data = self.model.get_tensor(self.output_details[0]['index'])
            
            return output_data
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è: {e}")
            return None
    
    def get_top_predictions(self, predictions, top_k=3):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–ø-K –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π"""
        try:
            # –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ —Ç–æ–ø-K –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
            top_indices = np.argsort(predictions[0])[-top_k:][::-1]
            top_probabilities = predictions[0][top_indices]
            
            return list(zip(top_indices, top_probabilities))
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ–ø –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π: {e}")
            return []
```

### üìÑ app\ui\__init__.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

### üìÑ app\ui\screens\__init__.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

### üìÑ app\ui\screens\camera_screen.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

### üìÑ app\ui\screens\catalog_screen.py
**–†–∞–∑–º–µ—Ä:** 66930 –±–∞–π—Ç  
```python
from kivy.lang import Builder
from kivy.uix.screenmanager import Screen
from kivymd.uix.bottomnavigation import MDBottomNavigationItem
from kivymd.uix.boxlayout import MDBoxLayout
from kivymd.uix.button import MDRaisedButton, MDFlatButton, MDIconButton
from kivymd.uix.dialog import MDDialog
from kivymd.uix.label import MDLabel
from kivymd.uix.list import MDList
from kivymd.uix.scrollview import ScrollView
from kivymd.uix.textfield import MDTextField
from kivymd.uix.menu import MDDropdownMenu
from kivymd.uix.card import MDCard
from kivymd.uix.selectioncontrol import MDCheckbox
from kivy.properties import StringProperty, BooleanProperty, ListProperty
from kivymd.uix.snackbar import Snackbar
from kivy.metrics import dp
from kivy.uix.relativelayout import RelativeLayout


Builder.load_string('''
<CatalogTab>:
    name: 'catalog'
    text: '–ö–∞—Ç–∞–ª–æ–≥'
    icon: 'view-list'
    
    MDBoxLayout:
        orientation: 'vertical'
        
        # –ü–∞–Ω–µ–ª—å –ø–æ–∏—Å–∫–∞ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
        MDBoxLayout:
            orientation: 'horizontal'
            adaptive_height: True
            padding: '10dp'
            spacing: '10dp'
            
            MDIconButton:
                icon: 'sort'
                theme_icon_color: "Custom"
                icon_color: "green"
                size_hint: None, None
                size: "40dp", "40dp"
                on_release: root.open_sort_menu()

            # –°—Ç—Ä–æ–∫–∞ –ø–æ–∏—Å–∫–∞ —Å –∫—Ä–µ—Å—Ç–∏–∫–æ–º
            MDBoxLayout:
                orientation: 'horizontal'
                size_hint_x: 0.6
                spacing: '5dp'
                height: self.minimum_height
                
                MDTextField:
                    id: search_input
                    hint_text: "–ü–æ–∏—Å–∫ ..."
                    mode: "rectangle"
                    size_hint_x: 0.85
                    on_text: root.search_pesticides(self.text)
                
                MDIconButton:
                    icon: 'close-circle'
                    theme_icon_color: "Custom"
                    icon_color: "gray" if root.ids.search_input.text else [0.5, 0.5, 0.5, 0.3]
                    size_hint: None, None
                    size: "40dp", "40dp"
                    on_release: 
                        root.ids.search_input.text = ""
                        root.search_pesticides("")
            
            MDIconButton:
                icon: 'close-circle'
                theme_icon_color: "Custom"
                icon_color: "gray"
                size_hint: None, None
                size: "40dp", "40dp"
                on_release: root.clear_search()
            
            MDIconButton:
                icon: 'filter'
                theme_icon_color: "Custom"
                icon_color: "green"
                size_hint: None, None
                size: "40dp", "40dp"
                on_release: root.open_filters_menu()        

        # –°–ø–∏—Å–æ–∫ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤
        ScrollView:
            MDList:
                id: pesticides_list
                padding: '10dp'
                spacing: '10dp'
    # –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–≤–µ—Ä—Ö —Å–ø–∏—Å–∫–∞
    MDFloatingActionButton:
        icon: "plus"
        type: "standard"
        md_bg_color: "green"
        elevation_normal: 12
        pos_hint: {"center_x": 0.5, "y": 0.02}
        size_hint: (None, None)
        size: ("56dp", "56dp")
        on_release: root.create_new_pesticide()

<PesticideCard>:
    orientation: 'vertical'
    padding: '12dp'
    spacing: '6dp'
    size_hint_y: None
    height: '120dp'
    ripple_behavior: True
    
    MDBoxLayout:
        orientation: 'horizontal'
        spacing: '12dp'
        size_hint_y: 1
        
        MDBoxLayout:
            orientation: 'vertical'
            size_hint_x: 0.7
            spacing: '4dp'
            
            MDLabel:
                id: name_label
                text: root.pesticide_name
                font_style: 'H6'
                theme_text_color: 'Primary'
                size_hint_y: None
                height: self.texture_size[1]
                halign: 'left'
                valign: 'top'
                shorten: True
                shorten_from: 'right'
                max_lines: 1
            
            MDLabel:
                id: substance_label
                text: f"–î–í: {root.pesticide_substance}"
                font_style: 'Body2'
                theme_text_color: 'Secondary'
                size_hint_y: None
                height: self.texture_size[1]
                halign: 'left'
                valign: 'top'
                shorten: True
                shorten_from: 'right'
                max_lines: 1
            
            MDLabel:
                id: description_label
                text: root.pesticide_description
                font_style: 'Body2'
                theme_text_color: 'Secondary'
                size_hint_y: None
                height: self.texture_size[1]
                halign: 'left'
                valign: 'top'
                shorten: True
                shorten_from: 'right'
                max_lines: 2
        
        MDBoxLayout:
            orientation: 'vertical'
            size_hint_x: 0.3
            spacing: '4dp'
            padding: '0dp', '4dp', '0dp', '0dp'
            
            MDLabel:
                id: price_label
                text: root.pesticide_price
                font_style: 'H6'
                theme_text_color: 'Primary'
                size_hint_y: None
                height: self.texture_size[1]
                halign: 'right'
                valign: 'top'
            
            MDLabel:
                id: packaging_label
                text: f"{root.pesticide_packaging} | {root.pesticide_application_rate}"
                font_style: 'Caption'
                theme_text_color: 'Secondary'
                size_hint_y: None
                height: self.texture_size[1]
                halign: 'right'
                valign: 'top'
                shorten: True
                shorten_from: 'right'
                max_lines: 2

<FilterDialog>:
    orientation: "vertical"
    spacing: "15dp"
    padding: "20dp"
    size_hint_y: None
    height: "500dp"
    
    ScrollView:
        MDBoxLayout:
            orientation: 'vertical'
            spacing: '10dp'
            size_hint_y: None
            height: '380dp'
            
            MDLabel:
                text: "–¢–∏–ø –ø–µ—Å—Ç–∏—Ü–∏–¥–∞:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: type_filter
                hint_text: "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø—ã..."
                mode: "rectangle"
                on_focus: if self.focus: root.catalog_instance.open_type_menu()
            
            # –ö—É–ª—å—Ç—É—Ä—ã
            MDLabel:
                text: "–ö—É–ª—å—Ç—É—Ä—ã:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: culture_filter
                hint_text: "–í—ã–±–µ—Ä–∏—Ç–µ –∫—É–ª—å—Ç—É—Ä—ã..."
                mode: "rectangle"
                on_focus: if self.focus: root.catalog_instance.open_culture_menu()
            
            # –ó–∞–±–æ–ª–µ–≤–∞–Ω–∏—è
            MDLabel:
                text: "–ó–∞–±–æ–ª–µ–≤–∞–Ω–∏—è:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: disease_filter
                hint_text: "–í—ã–±–µ—Ä–∏—Ç–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è..."
                mode: "rectangle"
                on_focus: if self.focus: root.catalog_instance.open_disease_menu()
            
            # –¶–µ–Ω–∞    
            MDLabel:
                text: "–¶–µ–Ω–∞ –æ—Ç:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDBoxLayout:
                orientation: 'horizontal'
                spacing: '10dp'
                size_hint_y: None
                height: '48dp'
                
                MDTextField:
                    id: min_price
                    hint_text: "0"
                    mode: "rectangle"
                    input_filter: 'float'
                
                MDLabel:
                    text: "–¥–æ"
                    size_hint_x: None
                    width: '30dp'
                
                MDTextField:
                    id: max_price
                    hint_text: "10000"
                    mode: "rectangle"
                    input_filter: 'float'
    
    MDBoxLayout:
        size_hint_y: None
        height: "48dp"
        spacing: "10dp"
        
        MDFlatButton:
            text: "–°–±—Ä–æ—Å–∏—Ç—å"
            on_release: root.reset_filters()
        
        MDRaisedButton:
            text: "–ü—Ä–∏–º–µ–Ω–∏—Ç—å"
            on_release: root.apply_filters()

<SortDialog>:
    orientation: "vertical"
    spacing: "15dp"
    padding: "20dp"
    size_hint_y: None
    height: "300dp"
    
    MDLabel:
        text: "–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ:"
        font_style: "H6"
        halign: "center"
        size_hint_y: None
        height: self.texture_size[1]
    
    MDBoxLayout:
        orientation: 'vertical'
        spacing: '10dp'
        
        MDLabel:
            text: "–ö—Ä–∏—Ç–µ—Ä–∏–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:"
            theme_text_color: "Secondary"
            size_hint_y: None
            height: self.texture_size[1]
        
        MDBoxLayout:
            orientation: 'horizontal'
            spacing: '20dp'
            
            MDBoxLayout:
                orientation: 'vertical'
                spacing: '5dp'
                
                MDLabel:
                    text: "–¶–µ–Ω–∞"
                    size_hint_y: None
                    height: self.texture_size[1]
                
                MDCheckbox:
                    group: 'sort_criteria'
                    id: sort_price
                    on_active: root.set_sort_criteria('price')
            
            MDBoxLayout:
                orientation: 'vertical'
                spacing: '5dp'
                
                MDLabel:
                    text: "–ù–∞–∑–≤–∞–Ω–∏–µ"
                    size_hint_y: None
                    height: self.texture_size[1]
                
                MDCheckbox:
                    group: 'sort_criteria'
                    id: sort_name
                    on_active: root.set_sort_criteria('name')
        
        MDLabel:
            text: "–ü–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏:"
            theme_text_color: "Secondary"
            size_hint_y: None
            height: self.texture_size[1]
        
        MDBoxLayout:
            orientation: 'horizontal'
            spacing: '20dp'
            
            MDBoxLayout:
                orientation: 'vertical'
                spacing: '5dp'
                
                MDLabel:
                    text: "–ü–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é"
                    size_hint_y: None
                    height: self.texture_size[1]
                
                MDCheckbox:
                    group: 'sort_order'
                    id: sort_asc
                    on_active: root.set_sort_order('asc')
            
            MDBoxLayout:
                orientation: 'vertical'
                spacing: '5dp'
                
                MDLabel:
                    text: "–ü–æ —É–±—ã–≤–∞–Ω–∏—é"
                    size_hint_y: None
                    height: self.texture_size[1]
                
                MDCheckbox:
                    group: 'sort_order'
                    id: sort_desc
                    on_active: root.set_sort_order('desc')
    
    MDBoxLayout:
        size_hint_y: None
        height: "48dp"
        spacing: "10dp"
        
        MDFlatButton:
            text: "–û—Ç–º–µ–Ω–∞"
            on_release: root.cancel_sort()
        
        MDRaisedButton:
            text: "–ü—Ä–∏–º–µ–Ω–∏—Ç—å"
            on_release: root.apply_sort()

<EditPesticideDialog>:
    orientation: "vertical"
    spacing: "15dp"
    padding: "20dp"
    size_hint_y: None
    height: "600dp"
    
    ScrollView:
        MDBoxLayout:
            orientation: 'vertical'
            spacing: '15dp'
            size_hint_y: None
            height: self.minimum_height
            padding: '10dp'
            
            # –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞
            MDLabel:
                text: "–ù–∞–∑–≤–∞–Ω–∏–µ:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: edit_name
                # hint_text: "–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞"
                mode: "rectangle"
            
            # –î–µ–π—Å—Ç–≤—É—é—â–µ–µ –≤–µ—â–µ—Å—Ç–≤–æ
            MDLabel:
                text: "–î–µ–π—Å—Ç–≤—É—é—â–µ–µ –≤–µ—â–µ—Å—Ç–≤–æ:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: edit_substance
                # hint_text: "–î–µ–π—Å—Ç–≤—É—é—â–µ–µ –≤–µ—â–µ—Å—Ç–≤–æ"
                mode: "rectangle"
            
            # –û–ø–∏—Å–∞–Ω–∏–µ
            MDLabel:
                text: "–û–ø–∏—Å–∞–Ω–∏–µ:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: edit_description
                # hint_text: "–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞"
                mode: "rectangle"
                multiline: True
                height: dp(80)
            
            # –ù–æ—Ä–º–∞ —Ä–∞—Å—Ö–æ–¥–∞
            MDLabel:
                text: "–ù–æ—Ä–º–∞ —Ä–∞—Å—Ö–æ–¥–∞:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: edit_application_rate
                # hint_text: "–ù–æ—Ä–º–∞ —Ä–∞—Å—Ö–æ–¥–∞"
                mode: "rectangle"
            
            # –§–∞—Å–æ–≤–∫–∞
            MDLabel:
                text: "–§–∞—Å–æ–≤–∫–∞:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: edit_packaging
                # hint_text: "–§–∞—Å–æ–≤–∫–∞"
                mode: "rectangle"
            
            # –¶–µ–Ω–∞
            MDLabel:
                text: "–¶–µ–Ω–∞:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: edit_price
                # hint_text: "–¶–µ–Ω–∞"
                mode: "rectangle"
                input_filter: 'float'
            
            # –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å
            MDLabel:
                text: "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: edit_manufacturer
                # hint_text: "–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å"
                mode: "rectangle"
            
            # –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è
            MDLabel:
                text: "–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: edit_unit
                hint_text: "—à—Ç/–∫–≥/–ª –∏ —Ç.–¥."
                mode: "rectangle"
            
            # –¢–∏–ø –ø–µ—Å—Ç–∏—Ü–∏–¥–∞ (–≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫)
            MDLabel:
                text: "–¢–∏–ø –ø–µ—Å—Ç–∏—Ü–∏–¥–∞:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: edit_type
                hint_text: "–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø..."
                mode: "rectangle"
                on_focus: if self.focus: root.open_type_menu()
            
            # –ë–æ–ª–µ–∑–Ω–∏ (–º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ –ø–æ–ª–µ)
            MDLabel:
                text: "–ë–æ–ª–µ–∑–Ω–∏:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: edit_diseases
                hint_text: "–ë–æ–ª–µ–∑–Ω–∏ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)"
                mode: "rectangle"
                multiline: True
                height: dp(60)
            
            # –ö—É–ª—å—Ç—É—Ä—ã (–º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ –ø–æ–ª–µ)
            MDLabel:
                text: "–ö—É–ª—å—Ç—É—Ä—ã:"
                theme_text_color: "Secondary"
                size_hint_y: None
                height: self.texture_size[1]
            
            MDTextField:
                id: edit_cultures
                hint_text: "–ö—É–ª—å—Ç—É—Ä—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)"
                mode: "rectangle"
                multiline: True
                height: dp(60)
    
    MDBoxLayout:
        size_hint_y: None
        height: "48dp"
        spacing: "10dp"
        
        MDRaisedButton:
            text: "–£–¥–∞–ª–∏—Ç—å"
            theme_text_color: "Custom"
            text_color: "white"
            md_bg_color: "red"
            on_release: root.delete_pesticide()
        
        MDFlatButton:
            text: "–û—Ç–º–µ–Ω–∞"
            on_release: root.cancel_edit()
        
        MDRaisedButton:
            text: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
            on_release: root.save_pesticide()
''')


class PesticideCard(MDCard):
    pesticide_name = StringProperty("")
    pesticide_substance = StringProperty("")
    pesticide_description = StringProperty("")
    pesticide_price = StringProperty("")
    pesticide_packaging = StringProperty("")
    pesticide_application_rate = StringProperty("")
    
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
    def on_pesticide_name(self, instance, value):
        # –ï—Å–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—É—Å—Ç–æ–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è"
        if not value:
            self.ids.name_label.text = "–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è"
        else:
            self.ids.name_label.text = value
    
    def on_pesticide_substance(self, instance, value):
        # –ï—Å–ª–∏ –î–í –ø—É—Å—Ç–æ–µ, –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–î–í:"
        if not value:
            self.ids.substance_label.text = ""
        else:
            self.ids.substance_label.text = f"–î–í: {value}"
    
    def on_pesticide_description(self, instance, value):
        # –ï—Å–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—É—Å—Ç–æ–µ, –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∏—á–µ–≥–æ
        if not value:
            self.ids.description_label.text = ""
        else:
            self.ids.description_label.text = value
    
    def on_pesticide_price(self, instance, value):
        # –ï—Å–ª–∏ —Ü–µ–Ω–∞ –ø—É—Å—Ç–∞—è, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º "–¶–µ–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞"
        if not value:
            self.ids.price_label.text = "–¶–µ–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞"
            self.ids.price_label.font_style = 'Body2'
            self.ids.price_label.theme_text_color = 'Secondary'
        else:
            self.ids.price_label.text = value
            self.ids.price_label.font_style = 'H6'
            self.ids.price_label.theme_text_color = 'Primary'
    
    def on_pesticide_packaging(self, instance, value):
        self._update_packaging_text()
    
    def on_pesticide_application_rate(self, instance, value):
        self._update_packaging_text()
    
    def _update_packaging_text(self):
        """–û–±–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—Å—Ç —Ñ–∞—Å–æ–≤–∫–∏ –∏ –Ω–æ—Ä–º—ã —Ä–∞—Å—Ö–æ–¥–∞"""
        packaging = self.pesticide_packaging
        rate = self.pesticide_application_rate
        
        if packaging and rate:
            self.ids.packaging_label.text = f"{packaging} | {rate}"
        elif packaging:
            self.ids.packaging_label.text = packaging
        elif rate:
            self.ids.packaging_label.text = f"–ù–æ—Ä–º–∞: {rate}"
        else:
            self.ids.packaging_label.text = ""

class FilterDialog(MDBoxLayout):
    def __init__(self, apply_callback, reset_callback, catalog_instance, current_filters, **kwargs):
        super().__init__(**kwargs)
        self.apply_callback = apply_callback
        self.reset_callback = reset_callback
        self.catalog_instance = catalog_instance
        self.current_filters = current_filters
        
        # –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
        if current_filters:
            if 'type' in current_filters and current_filters['type']:
                self.ids.type_filter.text = ', '.join(current_filters['type'])
            if 'cultures' in current_filters and current_filters['cultures']:
                self.ids.culture_filter.text = ', '.join(current_filters['cultures'])
            if 'diseases' in current_filters and current_filters['diseases']:
                self.ids.disease_filter.text = ', '.join(current_filters['diseases'])
            if 'min_price' in current_filters:
                self.ids.min_price.text = current_filters['min_price']
            if 'max_price' in current_filters:
                self.ids.max_price.text = current_filters['max_price']
    
    def apply_filters(self):
        self.apply_callback()
    
    def reset_filters(self):
        self.reset_callback()


class SortDialog(MDBoxLayout):
    def __init__(self, apply_callback, cancel_callback, current_sort, **kwargs):
        super().__init__(**kwargs)
        self.apply_callback = apply_callback
        self.cancel_callback = cancel_callback
        self.sort_criteria = current_sort.get('criteria', 'name')
        self.sort_order = current_sort.get('order', 'asc')
        
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
        if self.sort_criteria == 'price':
            self.ids.sort_price.active = True
        else:
            self.ids.sort_name.active = True
            
        if self.sort_order == 'asc':
            self.ids.sort_asc.active = True
        else:
            self.ids.sort_desc.active = True
    
    def set_sort_criteria(self, criteria):
        self.sort_criteria = criteria
    
    def set_sort_order(self, order):
        self.sort_order = order
    
    def apply_sort(self):
        self.apply_callback(self.sort_criteria, self.sort_order)
    
    def cancel_sort(self):
        self.cancel_callback()

class EditPesticideDialog(MDBoxLayout):
    def __init__(self, pesticide_data, save_callback, delete_callback, cancel_callback, catalog_instance, **kwargs):
        super().__init__(**kwargs)
        self.pesticide_data = pesticide_data
        self.save_callback = save_callback
        self.delete_callback = delete_callback
        self.cancel_callback = cancel_callback
        self.catalog_instance = catalog_instance
        self.type_menu = None
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º, —ç—Ç–æ –Ω–æ–≤—ã–π –ø—Ä–µ–ø–∞—Ä–∞—Ç –∏–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
        self.is_new = not pesticide_data.get('name', '')  # –ï—Å–ª–∏ –∏–º—è –ø—É—Å—Ç–æ–µ - –Ω–æ–≤—ã–π
        
        # –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª—è –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞
        self.ids.edit_name.text = pesticide_data.get('name', '')
        self.ids.edit_substance.text = pesticide_data.get('substance', '')
        self.ids.edit_description.text = pesticide_data.get('description', '')
        self.ids.edit_application_rate.text = pesticide_data.get('application_rate', '')
        self.ids.edit_packaging.text = pesticide_data.get('packaging', '')
        
        # –î–ª—è —Ü–µ–Ω—ã —É–¥–∞–ª—è–µ–º "—Ä—É–±." –µ—Å–ª–∏ –µ—Å—Ç—å
        price_text = pesticide_data.get('price', '')
        if '—Ä—É–±' in str(price_text):
            price_text = str(price_text).replace(' —Ä—É–±.', '').replace(' ', '')
        self.ids.edit_price.text = price_text
        
        self.ids.edit_manufacturer.text = pesticide_data.get('manufacturer', '')
        self.ids.edit_unit.text = pesticide_data.get('unit', '—à—Ç')
        self.ids.edit_type.text = pesticide_data.get('type', '–ì–µ—Ä–±–∏—Ü–∏–¥—ã')
        self.ids.edit_diseases.text = pesticide_data.get('diseases', '')
        self.ids.edit_cultures.text = pesticide_data.get('cultures', '')
    
    def open_type_menu(self):
        """–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ –ø–µ—Å—Ç–∏—Ü–∏–¥–∞ –ü–û–î –ø–æ–ª–µ–º"""
        try:
            # –ï—Å–ª–∏ –º–µ–Ω—é —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–æ, –∑–∞–∫—Ä–æ–π—Ç–µ –µ–≥–æ
            if self.type_menu and self.type_menu.parent:
                self.type_menu.dismiss()
                self.type_menu = None
                return
            
            # –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–µ—Å—Ç–∏—Ü–∏–¥–æ–≤
            pesticide_types = ["–ì–µ—Ä–±–∏—Ü–∏–¥—ã", "–ò–Ω—Å–µ–∫—Ç–∏—Ü–∏–¥—ã", "–§—É–Ω–≥–∏—Ü–∏–¥—ã", "–ë–∞–∫—Ç–µ—Ä–∏—Ü–∏–¥—ã", "–§—É–º–∏–≥–∞–Ω—Ç—ã"]
            
            # –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –º–µ–Ω—é
            menu_items = [
                {
                    "text": p_type,
                    "viewclass": "OneLineListItem",
                    "height": dp(48),
                    "on_release": lambda x=p_type: self.select_pesticide_type(x),
                } for p_type in pesticide_types
            ]
            
            # –°–æ–∑–¥–∞–µ–º –º–µ–Ω—é –ü–û–î –ø–æ–ª–µ–º
            self.type_menu = MDDropdownMenu(
                caller=self.ids.edit_type,
                items=menu_items,
                width=self.ids.edit_type.width * 1.5,  # –®–∏—Ä–∏–Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª—è –≤–≤–æ–¥–∞
                max_height=dp(150),
                position="auto",
                ver_growth="down"
            )
            self.type_menu.open()
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é —Ç–∏–ø–∞: {e}")
    
    def select_pesticide_type(self, pesticide_type):
        """–í—ã–±—Ä–∞—Ç—å —Ç–∏–ø –ø–µ—Å—Ç–∏—Ü–∏–¥–∞"""
        try:
            self.ids.edit_type.text = pesticide_type
            if self.type_menu:
                self.type_menu.dismiss()
                self.type_menu = None
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞: {e}")
    
    def save_pesticide(self):
        try:
            updated_data = {
                'name': self.ids.edit_name.text,
                'substance': self.ids.edit_substance.text,
                'description': self.ids.edit_description.text,
                'application_rate': self.ids.edit_application_rate.text,
                'packaging': self.ids.edit_packaging.text,
                'price': self.ids.edit_price.text,
                'manufacturer': self.ids.edit_manufacturer.text,
                'unit': self.ids.edit_unit.text,
                'type': self.ids.edit_type.text,
                'diseases': self.ids.edit_diseases.text,
                'cultures': self.ids.edit_cultures.text,
            }
            
            # –î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞ –¥–æ–±–∞–≤–ª—è–µ–º ID
            if not self.is_new and 'id' in self.pesticide_data:
                updated_data['id'] = self.pesticide_data['id']
            
            self.save_callback(updated_data)
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: {e}")
            self.catalog_instance._show_error_message(f"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: {e}")
    
    def delete_pesticide(self):
        if self.delete_callback:
            self.delete_callback(self.pesticide_data)
    
    def cancel_edit(self):
        # –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ
        if self.type_menu:
            self.type_menu.dismiss()
            self.type_menu = None
        self.cancel_callback()
    
    def on_dismiss(self):
        """–ó–∞–∫—Ä—ã—Ç—å –º–µ–Ω—é –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –¥–∏–∞–ª–æ–≥–∞"""
        if self.type_menu:
            self.type_menu.dismiss()
            self.type_menu = None


            
class CatalogTab(MDBottomNavigationItem):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.filters = {}
        self.sort_settings = {'criteria': 'name', 'order': 'asc'}
        self.filter_dialog = None
        self.type_menu = None
        self.culture_menu = None
        self.disease_menu = None
        self.sort_dialog = None
        self.detail_dialog = None
        self.edit_dialog = None
        self.current_editing_pesticide = None
        self.selected_types = []
        self.selected_cultures = []
        self.selected_diseases = []
        self.test_pesticides = self._get_test_pesticides()
    
    def on_enter(self):
        """–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É"""
        self._setup_catalog()
    
    def _setup_catalog(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞"""
        self._load_pesticides()
    
    def clear_search(self):
        """–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫"""
        self.ids.search_input.text = ""
        self._load_pesticides()
        print("üîÑ –ü–æ–∏—Å–∫ –æ—á–∏—â–µ–Ω")

    def on_search_text_change(self, instance, value):
        """–û–±–Ω–æ–≤–∏—Ç—å —Ü–≤–µ—Ç –∫—Ä–µ—Å—Ç–∏–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–µ–∫—Å—Ç–∞ –ø–æ–∏—Å–∫–∞"""
        if hasattr(self, 'search_clear_button'):
            if value:
                self.search_clear_button.icon_color = "gray"
            else:
                self.search_clear_button.icon_color = [0.5, 0.5, 0.5, 0.3]
# ============= –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ ======
    def reset_filters_and_search(self):
        """–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫"""
        # –°–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤
        self.filters = {}
        self.selected_types = []
        self.selected_cultures = []
        self.selected_diseases = []
        
        # –°–±—Ä–æ—Å –ø–æ–∏—Å–∫–∞
        self.ids.search_input.text = ""
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –æ—á–∏—Å—Ç–∫–∏ –ø–æ–∏—Å–∫–∞
        self.ids.search_clear_button.icon_color = [0.5, 0.5, 0.5, 0.3]
        
        # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –¥–∏–∞–ª–æ–≥–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ (–µ—Å–ª–∏ –æ–Ω –æ—Ç–∫—Ä—ã—Ç)
        if self.filter_dialog:
            content = self.filter_dialog.content_cls
            content.ids.type_filter.text = ""
            content.ids.culture_filter.text = ""
            content.ids.disease_filter.text = ""
            content.ids.min_price.text = ""
            content.ids.max_price.text = ""
        
        print("üîÑ –í—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∏—Å–∫ —Å–±—Ä–æ—à–µ–Ω—ã")
        self._load_pesticides()
# ============= –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ ======
    def create_new_pesticide(self):
        """–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–µ–ø–∞—Ä–∞—Ç"""
        print("‚ûï –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞")
        
        # –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞
        new_pesticide = {
            'id': len(self.test_pesticides) + 1,
            'name': '',
            'substance': '',
            'description': '',
            'application_rate': '',
            'packaging': '',
            'price': '',
            'manufacturer': '',
            'unit': '—à—Ç',
            'type': '–ì–µ—Ä–±–∏—Ü–∏–¥—ã',
            'cultures': '',
            'diseases': ''
        }
        
        self.current_editing_pesticide = new_pesticide
        
        # –°–æ–∑–¥–∞–µ–º –¥–∏–∞–ª–æ–≥ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        self.edit_dialog = MDDialog(
            title="–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–µ–ø–∞—Ä–∞—Ç–∞",
            type="custom",
            content_cls=EditPesticideDialog(
                pesticide_data=new_pesticide,
                save_callback=self.save_new_pesticide,
                delete_callback=None,
                cancel_callback=self.cancel_edit,
                catalog_instance=self,
                # is_new=True  # –£–∫–∞–∑—ã–≤–∞–µ–º —á—Ç–æ —ç—Ç–æ –Ω–æ–≤—ã–π –ø—Ä–µ–ø–∞—Ä–∞—Ç
            ),
            size_hint=(0.9, 0.8),
            auto_dismiss=False
        )
        self.edit_dialog.open()
# ============= –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ ======
    def save_new_pesticide(self, new_data):
        """–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤—ã–π –ø—Ä–µ–ø–∞—Ä–∞—Ç"""
        print(f"üíæ –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –ø—Ä–µ–ø–∞—Ä–∞—Ç: {new_data['name']}")
        
        try:
            # –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –µ—Å–ª–∏ –æ–Ω–æ –æ—Ç–∫—Ä—ã—Ç–æ
            if hasattr(self, 'edit_dialog') and self.edit_dialog:
                content = self.edit_dialog.content_cls
                if hasattr(content, 'type_menu') and content.type_menu:
                    content.type_menu.dismiss()

            # –î–æ–±–∞–≤–ª—è–µ–º ID –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ü–µ–Ω—É
            new_data['id'] = len(self.test_pesticides) + 1
            
            # –ó–∞–ø–æ–ª–Ω—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –µ—Å–ª–∏ –æ–Ω–∏ –ø—É—Å—Ç—ã–µ
            if not new_data.get('name'):
                new_data['name'] = '–ù–æ–≤—ã–π –ø—Ä–µ–ø–∞—Ä–∞—Ç'
            
            if new_data.get('price'):
                if '—Ä—É–±' not in str(new_data['price']):
                    new_data['price'] = f"{new_data['price']} —Ä—É–±."
            else:
                new_data['price'] = '–¶–µ–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞'
            
            if not new_data.get('unit'):
                new_data['unit'] = '—à—Ç'
            if not new_data.get('type'):
                new_data['type'] = '–ì–µ—Ä–±–∏—Ü–∏–¥—ã'
            
            # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–π –ø—Ä–µ–ø–∞—Ä–∞—Ç –≤ —Å–ø–∏—Å–æ–∫
            self.test_pesticides.append(new_data)
            
            # –ó–∞–∫—Ä—ã–≤–∞–µ–º –¥–∏–∞–ª–æ–≥ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            if self.edit_dialog:
                self.edit_dialog.dismiss()
            
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤
            self._load_pesticides(
                search_query=self.ids.search_input.text,
                filters=self.filters
            )
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
            self._show_success_message(f"–ü—Ä–µ–ø–∞—Ä–∞—Ç '{new_data['name']}' —Å–æ–∑–¥–∞–Ω")
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è: {e}")
            self._show_error_message(f"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è: {e}")

    def _load_pesticides(self, search_query="", filters=None, sort_criteria=None, sort_order=None):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤"""
        pesticides_list = self.ids.pesticides_list
        pesticides_list.clear_widgets()
        
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º self.test_pesticides
        test_pesticides = self.test_pesticides
        
        # –ü—Ä–∏–º–µ–Ω—è–µ–º –ø–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã
        filtered_pesticides = self._apply_filters(test_pesticides, search_query, filters)
        
        # –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
        sorted_pesticides = self._apply_sorting(filtered_pesticides, sort_criteria, sort_order)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã –≤ —Å–ø–∏—Å–æ–∫
        for pesticide in sorted_pesticides:
            card = PesticideCard()
            
            # –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –Ω–∞ None
            card.pesticide_name = pesticide.get('name', '')
            card.pesticide_substance = pesticide.get('substance', '')
            card.pesticide_description = pesticide.get('description', '')
            card.pesticide_price = pesticide.get('price', '')
            card.pesticide_packaging = pesticide.get('packaging', '')
            card.pesticide_application_rate = pesticide.get('application_rate', '')
            
            card.on_release = lambda p=pesticide: self.show_pesticide_details(p)
            
            pesticides_list.add_widget(card)
    
    def _apply_filters(self, pesticides, search_query, filters):
        """–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∫ —Å–ø–∏—Å–∫—É –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤"""
        filtered = pesticides
        
        # –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é, –æ–ø–∏—Å–∞–Ω–∏—é –∏ –≤–µ—â–µ—Å—Ç–≤—É
        if search_query:
            search_query = search_query.lower()

# ... —Ñ–∞–π–ª –æ–±—Ä–µ–∑–∞–Ω, –ø–æ–∫–∞–∑–∞–Ω–æ 1000 –∏–∑ 1665 —Å—Ç—Ä–æ–∫ ...
```

### üìÑ app\ui\screens\disease_detection_screen.py
**–†–∞–∑–º–µ—Ä:** 499 –±–∞–π—Ç  
```python
from kivy.lang import Builder
from kivymd.uix.bottomnavigation import MDBottomNavigationItem
from kivymd.uix.boxlayout import MDBoxLayout
from kivymd.uix.label import MDLabel

Builder.load_string('''
<DiseaseDetectionScreen>:
    orientation: 'vertical'
    padding: '20dp'
    spacing: '20dp'
    
    MDLabel:
        text: '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π'
        halign: 'center'
        font_style: 'H4'
''')

class DiseaseDetectionScreen(MDBoxLayout):
    pass
```

### üìÑ app\ui\screens\main_screen.py
**–†–∞–∑–º–µ—Ä:** 2183 –±–∞–π—Ç  
```python
from kivy.lang import Builder
from kivy.uix.screenmanager import Screen
from kivymd.uix.bottomnavigation import MDBottomNavigation, MDBottomNavigationItem
from kivymd.uix.label import MDLabel
from kivymd.uix.boxlayout import MDBoxLayout

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤–∫–ª–∞–¥–∫–∏ –∏–∑ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
from app.ui.screens.settings_screen import SettingsTab
from app.ui.screens.catalog_screen import CatalogTab

Builder.load_string('''
<MainScreen>:
    MDBottomNavigation:
        id: bottom_nav
        panel_color: "#f5f5f5"
        selected_color_background: "#e0f2f1"
        text_color_active: "green"

<DiagnosisTab>:
    name: 'diagnosis'
    text: '–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞'
    icon: 'camera'
    
    MDBoxLayout:
        orientation: 'vertical'
        padding: '20dp'
        
        MDLabel:
            text: '–ú–æ–¥—É–ª—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π'
            halign: 'center'
            font_style: 'H5'
        
<OrdersTab>:
    name: 'orders'
    text: '–ó–∞–∫–∞–∑—ã'
    icon: 'cart'
    
    MDBoxLayout:
        orientation: 'vertical'
        padding: '20dp'
        
        MDLabel:
            text: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏'
            halign: 'center'
            font_style: 'H5'
''')

# –ö–ª–∞—Å—Å—ã –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
class DiagnosisTab(MDBottomNavigationItem):
    pass

class OrdersTab(MDBottomNavigationItem):
    pass

class MainScreen(Screen):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        
    def on_enter(self):
        """–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ —ç–∫—Ä–∞–Ω"""
        self._setup_navigation()
    
    def _setup_navigation(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∏–∂–Ω–µ–π –ø–∞–Ω–µ–ª–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏"""
        bottom_nav = self.ids.bottom_nav
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≤–∫–ª–∞–¥–∫–∏
        bottom_nav.add_widget(DiagnosisTab())
        bottom_nav.add_widget(CatalogTab())  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å
        bottom_nav.add_widget(OrdersTab())
        bottom_nav.add_widget(SettingsTab())
```

### üìÑ app\ui\screens\orders_screen.py
**–†–∞–∑–º–µ—Ä:** 632 –±–∞–π—Ç  
```python
from kivy.lang import Builder
from kivymd.uix.bottomnavigation import MDBottomNavigationItem
from kivymd.uix.boxlayout import MDBoxLayout
from kivymd.uix.label import MDLabel

Builder.load_string('''
<OrdersTab>:
    name: 'orders'
    text: '–ó–∞–∫–∞–∑—ã'
    icon: 'cart'
    
    MDBoxLayout:
        orientation: 'vertical'
        padding: '20dp'
        
        MDLabel:
            text: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏'
            halign: 'center'
            font_style: 'H5'
''')

class OrdersTab(MDBottomNavigationItem):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
```

### üìÑ app\ui\screens\results_screen.py
**–†–∞–∑–º–µ—Ä:** 407 –±–∞–π—Ç  
```python
from kivy.lang import Builder
from kivymd.uix.boxlayout import MDBoxLayout
from kivymd.uix.label import MDLabel

Builder.load_string('''
<ResultsScreen>:
    orientation: 'vertical'
    padding: '20dp'
    spacing: '20dp'
    
    MDLabel:
        text: '–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞'
        halign: 'center'
        font_style: 'H4'
''')

class ResultsScreen(MDBoxLayout):
    pass
```

### üìÑ app\ui\screens\settings_screen.py
**–†–∞–∑–º–µ—Ä:** 8467 –±–∞–π—Ç  
```python
from kivy.lang import Builder
from kivy.uix.screenmanager import Screen
from kivymd.uix.bottomnavigation import MDBottomNavigationItem
from kivymd.uix.boxlayout import MDBoxLayout
from kivymd.uix.button import MDRaisedButton, MDFlatButton
from kivymd.uix.dialog import MDDialog
from kivymd.uix.label import MDLabel
from kivymd.uix.list import MDList, OneLineListItem
from kivymd.uix.scrollview import ScrollView

Builder.load_string('''
<SettingsTab>:
    name: 'settings'
    text: '–ò–º–ø–æ—Ä—Ç/–≠–∫—Å–ø–æ—Ä—Ç'
    icon: 'database-export'
    
    MDBoxLayout:
        orientation: 'vertical'
        padding: '20dp'
        spacing: '20dp'
        
        MDLabel:
            text: '–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏'
            halign: 'center'
            font_style: 'H5'
            size_hint_y: None
            height: self.texture_size[1]
        
        ScrollView:
            MDList:
                id: settings_list
                
<ImportExportDialog>:
    orientation: "vertical"
    spacing: "10dp"
    padding: "20dp"
    size_hint_y: None
    height: "200dp"
    
    MDLabel:
        text: root.dialog_text
        halign: "center"
        theme_text_color: "Secondary"
        size_hint_y: None
        height: self.texture_size[1]
    
    MDBoxLayout:
        size_hint_y: None
        height: "48dp"
        spacing: "10dp"
        
        MDFlatButton:
            text: "–û—Ç–º–µ–Ω–∞"
            on_release: root.cancel_callback()
        
        MDRaisedButton:
            text: "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å"
            on_release: root.confirm_callback()
''')

class ImportExportDialog(MDBoxLayout):
    """–î–∏–∞–ª–æ–≥ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π –∏–º–ø–æ—Ä—Ç–∞/—ç–∫—Å–ø–æ—Ä—Ç–∞"""
    
    def __init__(self, dialog_text, confirm_callback, cancel_callback, **kwargs):
        super().__init__(**kwargs)
        self.dialog_text = dialog_text
        self.confirm_callback = confirm_callback
        self.cancel_callback = cancel_callback

class SettingsTab(MDBottomNavigationItem):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.dialog = None
        
    def on_enter(self):
        """–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É"""
        self._setup_settings_list()
    
    def _setup_settings_list(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ø–∏—Å–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤"""
        settings_list = self.ids.settings_list
        settings_list.clear_widgets()
        
        # –°–µ–∫—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
        settings_list.add_widget(OneLineListItem(
            text="üì• –ò–º–ø–æ—Ä—Ç –ø—Ä–µ–ø–∞—Ä–∞—Ç–æ–≤ –∏–∑ Excel",
            on_release=lambda x: self.show_import_dialog("–ø—Ä–µ–ø–∞—Ä–∞—Ç—ã")
        ))
        
        settings_list.add_widget(OneLineListItem(
            text="üì• –ò–º–ø–æ—Ä—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏–∑ Excel", 
            on_release=lambda x: self.show_import_dialog("–∫–ª–∏–µ–Ω—Ç—ã")
        ))
        
        # –°–µ–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
        settings_list.add_widget(OneLineListItem(
            text="üì§ –≠–∫—Å–ø–æ—Ä—Ç –∫–∞—Ç–∞–ª–æ–≥–∞ –≤ Excel",
            on_release=lambda x: self.show_export_dialog("–∫–∞—Ç–∞–ª–æ–≥")
        ))
        
        settings_list.add_widget(OneLineListItem(
            text="üì§ –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–∫–∞–∑–æ–≤ –≤ Excel",
            on_release=lambda x: self.show_export_dialog("–∑–∞–∫–∞–∑—ã")
        ))
        
        settings_list.add_widget(OneLineListItem(
            text="üìÑ –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è",
            on_release=lambda x: self.show_export_dialog("–ö–ü")
        ))
        
        # –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ë–î
        settings_list.add_widget(OneLineListItem(
            text="üîÑ –û–±–Ω–æ–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö",
            on_release=lambda x: self.update_database()
        ))
        
        settings_list.add_widget(OneLineListItem(
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ",
            on_release=lambda x: self.clear_database()
        ))
        settings_list.add_widget(OneLineListItem(
            text="üîÑ –û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π",
            on_release=lambda x: self.update_disease_classes()
        ))
    
    def update_disease_classes(self):
        """–û–±–Ω–æ–≤–∏—Ç—å –∫–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ —Ñ–∞–π–ª–∞"""
        try:
            # –ó–¥–µ—Å—å –±—É–¥–µ—Ç –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ –∏–∑ –ë–î
            print("üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏–∑ —Ñ–∞–π–ª–∞")
            self.show_message("–ö–ª–∞—Å—Å—ã –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞ disease_classes.txt")
        except Exception as e:
            self.show_message(f"‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: {e}")

    def show_import_dialog(self, data_type):
        """–ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –∏–º–ø–æ—Ä—Ç–∞"""
        self.dialog = MDDialog(
            title=f"–ò–º–ø–æ—Ä—Ç {data_type}",
            type="custom",
            content_cls=ImportExportDialog(
                dialog_text=f"–§—É–Ω–∫—Ü–∏—è –∏–º–ø–æ—Ä—Ç–∞ {data_type} –∏–∑ Excel –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏.",
                confirm_callback=lambda: self.import_data(data_type),
                cancel_callback=self.close_dialog
            ),
            size_hint=(0.8, None),
            height="250dp"
        )
        self.dialog.open()
    
    def show_export_dialog(self, data_type):
        """–ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ —ç–∫—Å–ø–æ—Ä—Ç–∞"""
        self.dialog = MDDialog(
            title=f"–≠–∫—Å–ø–æ—Ä—Ç {data_type}",
            type="custom", 
            content_cls=ImportExportDialog(
                dialog_text=f"–§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ {data_type} –≤ Excel –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏.",
                confirm_callback=lambda: self.export_data(data_type),
                cancel_callback=self.close_dialog
            ),
            size_hint=(0.8, None),
            height="250dp"
        )
        self.dialog.open()
    
    def import_data(self, data_type):
        """–ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö"""
        print(f"üì• –ò–º–ø–æ—Ä—Ç {data_type} –∏–∑ Excel")
        self.show_message(f"–ò–º–ø–æ—Ä—Ç {data_type} –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!")
        self.close_dialog()
    
    def export_data(self, data_type):
        """–ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö"""
        print(f"üì§ –≠–∫—Å–ø–æ—Ä—Ç {data_type} –≤ Excel")
        self.show_message(f"–≠–∫—Å–ø–æ—Ä—Ç {data_type} –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!")
        self.close_dialog()
    
    def update_database(self):
        """–ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ë–î"""
        print("üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö")
        self.show_message("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∞!")
    
    def clear_database(self):
        """–ó–∞–≥–ª—É—à–∫–∞ –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö"""
        self.dialog = MDDialog(
            title="–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö",
            text="–≠—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏—è —É–¥–∞–ª–∏—Ç –≤—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?",
            buttons=[
                MDFlatButton(
                    text="–û—Ç–º–µ–Ω–∞",
                    on_release=lambda x: self.close_dialog()
                ),
                MDRaisedButton(
                    text="–û—á–∏—Å—Ç–∏—Ç—å",
                    on_release=lambda x: self.confirm_clear()
                )
            ]
        )
        self.dialog.open()
    
    def confirm_clear(self):
        """–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö"""
        print("üóëÔ∏è –û—á–∏—Å—Ç–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö")
        self.show_message("–õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã!")
        self.close_dialog()
    
    def show_message(self, message):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ (–≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ Snackbar)"""
        print(f"üí¨ {message}")
    
    def close_dialog(self):
        """–ó–∞–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –æ–∫–Ω–æ"""
        if self.dialog:
            self.dialog.dismiss()
            self.dialog = None
    
```

### üìÑ app\ui\widgets\__init__.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

### üìÑ app\ui\widgets\custom_buttons.py
**–†–∞–∑–º–µ—Ä:** 955 –±–∞–π—Ç  
```python
from kivy.uix.behaviors import ButtonBehavior
from kivymd.uix.boxlayout import MDBoxLayout
from kivymd.uix.label import MDLabel
from kivy.properties import StringProperty

class NavigationButton(ButtonBehavior, MDBoxLayout):
    """–ö–Ω–æ–ø–∫–∞ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ —Å –∏–∫–æ–Ω–∫–æ–π –∏ —Ç–µ–∫—Å—Ç–æ–º"""
    icon = StringProperty("")
    text = StringProperty("")
    
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.orientation = "vertical"
        self.size_hint = (None, None)
        self.size = ("80dp", "80dp")
        self.padding = "10dp"
        self.spacing = "5dp"

class PrimaryButton(ButtonBehavior, MDBoxLayout):
    """–û—Å–Ω–æ–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
    text = StringProperty("")
    
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        self.size_hint = (None, None)
        self.height = "48dp"
        self.padding = "20dp", "10dp"
```

### üìÑ app\ui\widgets\image_widgets.py
**–†–∞–∑–º–µ—Ä:** 364 –±–∞–π—Ç  
```python
from kivy.uix.image import Image
from kivy.uix.behaviors import ButtonBehavior
from kivymd.uix.boxlayout import MDBoxLayout

class ClickableImage(ButtonBehavior, Image):
    """–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –Ω–∞–∂–∞—Ç–∏—è"""
    pass

class ImageWithCaption(MDBoxLayout):
    """–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –ø–æ–¥–ø–∏—Å—å—é"""
    pass
```

### üìÑ tests\__init__.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

### üìÑ tests\test_basic.py
**–†–∞–∑–º–µ—Ä:** 0 –±–∞–π—Ç  
```python

```

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 32
- **–ò—Å–∫–ª—é—á–µ–Ω–æ —Ñ–∞–π–ª–æ–≤:** 2
- **–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä:** 341004 –±–∞–π—Ç (333.01 KB)
- **–î–∞—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞:** 2025-12-06 13:29:01
